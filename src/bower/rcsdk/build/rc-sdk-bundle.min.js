!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("dom-storage"),function(){try{return require("xhr2")}catch(t){}}()):"function"==typeof define&&define.amd?define(["exports","exports"],e):"object"==typeof exports?exports.RCSDK=e(require("dom-storage"),function(){try{return require("xhr2")}catch(t){}}()):t.RCSDK=e(t.localStorage,t.XMLHttpRequest)}(this,function(__WEBPACK_EXTERNAL_MODULE_45__,__WEBPACK_EXTERNAL_MODULE_46__){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(1),i=n(5),o=n(6),s=n(7),u=n(8),a=n(9),c=n(10),p=n(11),l=n(4),f=n(2),h=n(12),d=n(13),y=n(17),g=n(3),m=n(18),v=n(19),b=n(20),_=n(21),x=n(24),w=n(25),S=n(26),k=n(27),E=n(28),C=n(29),O=n(23),T=n(30),P=n(31),A=n(32),M=n(34),j=n(35),I=n(22),F=n(36),N=n(37),H=n(38),B=n(33),U=n(39),$=n(40),R=n(43),L=function(){function t(e){e=e||{},this._context=a.$get(t.injections),this.getCache().setPrefix(e.cachePrefix||""),this.getPlatform().setServer(e.server||"").setCredentials(e.appKey||"",e.appSecret||"")}return t.prototype.getContext=function(){return this._context},t.prototype.getAjaxObserver=function(){return s.$get(this.getContext())},t.prototype.getXhrResponse=function(){return o.$get(this.getContext())},t.prototype.getPlatform=function(){return d.$get(this.getContext())},t.prototype.getCache=function(){return u.$get(this.getContext())},t.prototype.getSubscription=function(){return y.$get(this.getContext())},t.prototype.getPageVisibility=function(){return h.$get(this.getContext())},t.prototype.getHelper=function(){return c.$get(this.getContext())},t.prototype.getObservable=function(){return f.$get(this.getContext())},t.prototype.getValidator=function(){return m.$get(this.getContext())},t.prototype.getLog=function(){return l.$get(this.getContext())},t.prototype.getUtils=function(){return g.$get(this.getContext())},t.prototype.getList=function(){return p.$get(this.getContext())},t.prototype.getCountryHelper=function(){return k.$get(this.getContext())},t.prototype.getDeviceModelHelper=function(){return C.$get(this.getContext())},t.prototype.getLanguageHelper=function(){return P.$get(this.getContext())},t.prototype.getLocationHelper=function(){return A.$get(this.getContext())},t.prototype.getShippingMethodHelper=function(){return H.$get(this.getContext())},t.prototype.getStateHelper=function(){return B.$get(this.getContext())},t.prototype.getTimezoneHelper=function(){return U.$get(this.getContext())},t.prototype.getAccountHelper=function(){return v.$get(this.getContext())},t.prototype.getBlockedNumberHelper=function(){return b.$get(this.getContext())},t.prototype.getCallHelper=function(){return _.$get(this.getContext())},t.prototype.getConferencingHelper=function(){return S.$get(this.getContext())},t.prototype.getContactHelper=function(){return x.$get(this.getContext())},t.prototype.getContactGroupHelper=function(){return w.$get(this.getContext())},t.prototype.getDeviceHelper=function(){return E.$get(this.getContext())},t.prototype.getExtensionHelper=function(){return O.$get(this.getContext())},t.prototype.getForwardingNumberHelper=function(){return T.$get(this.getContext())},t.prototype.getMessageHelper=function(){return M.$get(this.getContext())},t.prototype.getPhoneNumberHelper=function(){return j.$get(this.getContext())},t.prototype.getPresenceHelper=function(){return I.$get(this.getContext())},t.prototype.getRingoutHelper=function(){return F.$get(this.getContext())},t.prototype.getServiceHelper=function(){return N.$get(this.getContext())},t.version="1.3.2",t.url={sandbox:"https://platform.devtest.ringcentral.com",production:"https://platform.ringcentral.com"},t.injections={localStorage:"undefined"!=typeof localStorage?localStorage:n(45),Promise:"undefined"!=typeof Promise?Promise:$.Promise||$,PUBNUB:R,XHR:function(){try{return new XMLHttpRequest}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(r){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(i){}try{return new(n(46))}catch(o){}throw new Error("This browser does not support XMLHttpRequest.")},pubnubMock:r,xhrMock:i},t}();t.exports=L},function(t,e,n){function r(t){return new u(t)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(2),s=function(t){function e(e,n){this.options=n,this.crypto_obj=e.getPubnubReal().crypto_obj,t.call(this,e)}return i(e,t),e.prototype.ready=function(){},e.prototype.subscribe=function(t){this.on("message-"+t.channel,t.message)},e.prototype.unsubscribe=function(t){this.off("message-"+t.channel)},e.prototype.receiveMessage=function(t,e){this.emit("message-"+e,t,"env",e)},e}(o.Observable);e.PubnubMock=s;var u=function(){function t(t){this.context=t,this.crypto_obj=t.getPubnubReal().crypto_obj}return t.prototype.init=function(t){return new s(this.context,t)},t}();e.PubnubFactory=u,e.$get=r},function(t,e,n){function r(t){return new s(t)}var i=n(3),o=n(4),s=function(){function t(e){if(!(this instanceof t))throw new Error("Observable(): New operator was omitted");Object.defineProperty(this,"listeners",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeEvents",{value:{},enumerable:!1,writable:!0}),Object.defineProperty(this,"oneTimeArguments",{value:{},enumerable:!1,writable:!0}),this.context=e,this.utils=i.$get(e),this.log=o.$get(e)}return t.prototype.hasListeners=function(t){return t in this.listeners},t.prototype.registerOneTimeEvent=function(t){this.oneTimeEvents[t]=!1,this.oneTimeArguments[t]=[]},t.prototype.on=function(t,e){var n=this;if("string"==typeof t&&(t=[t]),!t)throw new Error("No events to subscribe to");if("function"!=typeof e)throw new Error("Callback must be a function");var r=this;return t.forEach(function(t){r.hasListeners(t)||(r.listeners[t]=[]),r.listeners[t].push(e),r.isOneTimeEventFired(t)&&(n.log.debug("Observable.on(%s): One-time event has been fired already, executing callback",t),e.apply(r,r.getOneTimeEventArgumens(t)))}),this},t.prototype.emit=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(this.isOneTimeEventFired(t))return this.log.debug("Observable.emit(%s): One-time event has been fired already",t),null;var i=null;return this.isOneTimeEvent(t)&&(this.setOneTimeEventFired(t),this.setOneTimeEventArgumens(t,n)),this.hasListeners(t)?(this.listeners[t].some(function(t){return i=t.apply(e,n),i===!1}),i):null},t.prototype.off=function(t,e){var n=this;if(t)if(e){if(!this.hasListeners(t))return this;this.listeners[t].forEach(function(r,i){r===e&&delete n.listeners[t][i]})}else delete this.listeners[t];else this.listeners={},this.oneTimeEvents={},this.oneTimeArguments={};return this},t.prototype.isOneTimeEvent=function(t){return t in this.oneTimeEvents},t.prototype.isOneTimeEventFired=function(t){return this.isOneTimeEvent(t)?this.oneTimeEvents[t]:!1},t.prototype.setOneTimeEventFired=function(t){this.oneTimeEvents[t]=!0},t.prototype.setOneTimeEventArgumens=function(t,e){this.oneTimeArguments[t]=e},t.prototype.getOneTimeEventArgumens=function(t){return this.oneTimeArguments[t]},t.prototype.offAll=function(){return this.off()},t.prototype.destroy=function(){return this.off(),this.log.debug("Observable.destroy(): Listeners were destroyed"),this},t.prototype.emitAndCallback=function(t,e,n){return e=this.utils.argumentsToArray(e),t&&this.emit.apply(this,[t].concat(e)),n&&n.apply(this,e),this},t}();e.Observable=s,e.$get=r},function(t,e){function n(t){return t.createSingleton("Utils",function(){return new u})}var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=/\d/,s={};"Boolean Number String Function Array Date RegExp Object".split(" ").forEach(function(t){s["[object "+t+"]"]=t.toLowerCase()});var u=function(){function t(){}return t.prototype.extend=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i,o,s,u,a,c,p=arguments[0]||{},l=1,f=arguments.length,h=!1;for("boolean"==typeof p&&(h=p,p=arguments[l]||{},l++),"object"==typeof p||this.isFunction(p)||(p={});f>l;l++)if(null!==(i=arguments[l]))for(o in i)s=p[o],u=i[o],p!==u&&(h&&u&&(this.isPlainObject(u)||(a=this.isArray(u)))?(a?(a=!1,c=s&&this.isArray(s)?s:[]):c=s&&this.isPlainObject(s)?s:{},p[o]=this.extend(h,c,u)):void 0!==u&&(p[o]=u));return p},t.prototype.forEach=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=e(t[n],n);if(r===!1)break}},t.prototype.queryStringify=function(t){var e=this,n=[];return this.forEach(t,function(t,r){e.isArray(t)?t.forEach(function(t){n.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):n.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}),n.join("&")},t.prototype.parseQueryString=function(t){var e={},n=this;return t.split("&").forEach(function(t){if(t=decodeURIComponent(t),-1==t.indexOf("="))e[t.trim()]=!0;else{var r=t.split("="),i=r[0].trim(),o=r[1].trim();i in e?(i in e&&!n.isArray(e[i])&&(e[i]=[e[i]]),e[i].push(o)):e[i]=o}}),e},t.prototype.isEmail=function(t,e){return e?/^(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?[ ,;]*)+$/i.test(t):/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(t)},t.prototype.isPhoneNumber=function(t){return/\+?1[0-9]{3}[0-9a-z]{7}/im.test(t.toString().split(/[^0-9a-z\+]/im).join(""))},t.prototype.argumentsToArray=function(t){return Array.prototype.slice.call(t||[],0)},t.prototype.isDate=function(t){return"date"===this.type(t)},t.prototype.isFunction=function(t){return"function"===this.type(t)},t.prototype.isArray=function(t){return Array.isArray?Array.isArray(t):"array"===this.type(t)},t.prototype.isWindow=function(t){return t&&"object"==typeof t&&"setInterval"in t},t.prototype.isNaN=function(t){return null===t||!o.test(t)||isNaN(t)},t.prototype.type=function(t){return null===t?String(t):s[i.call(t)]||"object"},t.prototype.isPlainObject=function(t){if(!t||"object"!==this.type(t)||t.nodeType||this.isWindow(t))return!1;if(t.constructor&&!r.call(t,"constructor")&&!r.call(t.constructor.prototype,"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||r.call(t,e)},t.prototype.getProperty=function(t,e){return e.split(/[.[\]]/).reduce(function(t,e){return t?e?t[e]:t:void 0},t)},t.prototype.poll=function(t,e,n){this.stopPolling(n),e=e||1e3;var r=function(n){return n=n||e,e=n,setTimeout(function(){t(r,n)},n)};return r()},t.prototype.stopPolling=function(t){t&&clearTimeout(t)},t.prototype.parseString=function(t){return t?t.toString():""},t.prototype.parseNumber=function(t){return t?(t=parseFloat(t),isNaN(t)?0:t):0},t}();e.Utils=u,e.$get=n},function(t,e,n){function r(t){return t.createSingleton("Log",function(){return new o(t,console)})}var i=n(3),o=function(){function t(t,e){e||(e={log:function(){},warn:function(){},info:function(){},error:function(){}}),this.context=t,this.console=e,this.utils=i.$get(t),this.logDebug=!1,this.logInfo=!1,this.logWarnings=!1,this.logErrors=!1,this.addTimestamps=!1}return t.prototype.disableAll=function(){this.logDebug=!1,this.logInfo=!1,this.logWarnings=!1,this.logErrors=!1},t.prototype.enableAll=function(){this.logDebug=!0,this.logInfo=!0,this.logWarnings=!0,this.logErrors=!0},t.prototype.parseArguments=function(t){return t=this.utils.argumentsToArray(t),this.addTimestamps&&t.unshift((new Date).toLocaleString(),"-"),t},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logDebug&&this.console.log.apply(this.console,this.parseArguments(arguments))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logInfo&&this.console.info.apply(this.console,this.parseArguments(arguments))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logWarnings&&this.console.warn.apply(this.console,this.parseArguments(arguments))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.logErrors&&this.console.error.apply(this.console,this.parseArguments(arguments))},t}();e.Log=o,e.$get=r},function(t,e,n){function r(t){return new u(t)}var i=n(3),o=n(4),s=n(6),u=function(){function t(t){this.context=t,this.responses=s.$get(t),this.log=o.$get(t),this.utils=i.$get(t),this.async=!0,this.method="",this.url="",this.requestHeaders={},this.withCredentials=!1,this.data=null,this.readyState=0,this.responseHeaders={},this.status=0}return t.prototype.getResponseHeader=function(t){return this.responseHeaders[t.toLowerCase()]},t.prototype.setRequestHeader=function(t,e){this.requestHeaders[t.toLowerCase()]=e},t.prototype.getAllResponseHeaders=function(){var t=[];return this.utils.forEach(this.responseHeaders,function(e,n){t.push(n+":"+e)}),t.join("\n")},t.prototype.open=function(t,e,n){this.method=t,this.url=e,this.async=n},t.prototype.send=function(t){var e=this,n=this.getRequestHeader("Content-Type");this.data=t,this.data&&"string"==typeof this.data&&("application/json"==n&&(this.data=JSON.parse(this.data)),"application/x-www-form-urlencoded"==n&&(this.data=this.utils.parseQueryString(this.data))),this.log.debug("API REQUEST",this.method,this.url);var r=this.responses.find(this);if(!r)return void setTimeout(function(){e.onerror&&e.onerror(new Error("Unknown request: "+e.url))},1);this.setStatus(200),this.setResponseHeader("Content-Type","application/json");var i=r.response(this),o=this.context.getPromise(),s=function(t){"application/json"==e.getResponseHeader("Content-Type")&&(t=JSON.stringify(t)),e.responseText=t,setTimeout(function(){e.onload&&e.onload()},1)};i instanceof o?i.then(s.bind(this))["catch"](this.onerror.bind(this)):s(i)},t.prototype.abort=function(){this.log.debug("XhrMock.destroy(): Aborted")},t.prototype.getRequestHeader=function(t){return this.requestHeaders[t.toLowerCase()]},t.prototype.setResponseHeader=function(t,e){this.responseHeaders[t.toLowerCase()]=e},t.prototype.setStatus=function(t){return this.status=t,this},t}();e.XhrMock=u,e.$get=r},function(t,e){function n(t){return t.createSingleton("XhrResponse",function(){return new r(t)})}var r=function(){function t(t){this.responses=[]}return t.prototype.add=function(t){this.responses.push(t)},t.prototype.clear=function(){this.responses=[]},t.prototype.find=function(t){var e=null;return this.responses.forEach(function(n){t.url.indexOf(n.path)>-1&&(!n.test||n.test(t))&&(e=n)}),e},t}();e.XhrResponse=r,e.$get=n},function(t,e,n){function r(t){return t.createSingleton("AjaxObserver",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(2),s=function(t){function e(){t.apply(this,arguments),this.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"}}return i(e,t),e}(o.Observable);e.AjaxObserver=s,e.$get=r},function(t,e){function n(t){return t.createSingleton("Cache",function(){return new r(t)})}var r=function(){function t(t){this.setPrefix(),this.context=t,this.storage=t.getLocalStorage()}return t.prototype.setPrefix=function(t){return this.prefix=t||"rc-",this},t.prototype.prefixKey=function(t){return this.prefix+t},t.prototype.setItem=function(t,e){return this.storage.setItem(this.prefixKey(t),JSON.stringify(e)),this},t.prototype.removeItem=function(t){return this.storage.removeItem(this.prefixKey(t)),this},t.prototype.getItem=function(t){var e=this.storage.getItem(this.prefixKey(t));return e?JSON.parse(e):null},t.prototype.clean=function(){for(var t in this.storage)this.storage.hasOwnProperty(t)&&0===t.indexOf(this.prefix)&&(this.storage.removeItem(t),delete this.storage[t]);return this},t}();e.Cache=r,e.$get=n},function(t,e){function n(t){return new r(t)}var r=function(){function t(t){this.singletons={},this.injections=t,this.stubPubnub=!1,this.stubAjax=!1}return t.prototype.createSingleton=function(t,e){return this.singletons[t]||(this.singletons[t]=e()),this.singletons[t]},t.prototype.usePubnubStub=function(t){return this.stubPubnub=!!t,this},t.prototype.useAjaxStub=function(t){return this.stubAjax=!!t,this},t.prototype.getPubnub=function(){return this.stubPubnub?this.injections.pubnubMock.$get(this):this.getPubnubReal()},t.prototype.getPubnubReal=function(){return this.injections.PUBNUB},t.prototype.getLocalStorage=function(){var t=this;return this.createSingleton("localStorage",function(){return"function"!=typeof t.injections.localStorage?t.injections.localStorage:new t.injections.localStorage})},t.prototype.getPromise=function(){return this.injections.Promise},t.prototype.getXHR=function(){return this.stubAjax?this.injections.xhrMock.$get(this):this.injections.XHR()},t}();e.Context=r,e.$get=n},function(t,e,n){function r(t){return new o(t)}var i=n(3),o=function(){function t(t){this.defaultProperty="id",this.context=t,this.utils=i.$get(t)}return t.prototype.getContext=function(){return this.context},t.prototype.createUrl=function(t,e){return""},t.prototype.getId=function(t){return t&&t[this.defaultProperty]},t.prototype.isNew=function(t){return!this.getId(t)||!this.getUri(t)},t.prototype.resetAsNew=function(t){return t&&(delete t.id,delete t.uri),t},t.prototype.getUri=function(t){return t&&t.uri},t.prototype.parseMultipartResponse=function(t){return t.isMultipart()?t.data.filter(function(t){return!t.error}).map(function(t){return t.data}):[t.data]},t.prototype.loadRequest=function(t,e){return this.utils.extend(e||{},{url:e&&e.url||t&&this.getUri(t)||this.createUrl(),method:e&&e.method||"GET"})},t.prototype.saveRequest=function(t,e){if(!(t||e&&(e.post||e.body)))throw new Error("No Object");return this.utils.extend(e||{},{method:e&&e.method||(this.isNew(t)?"POST":"PUT"),url:e&&e.url||this.getUri(t)||this.createUrl(),body:e&&(e.body||e.post)||t})},t.prototype.deleteRequest=function(t,e){if(e=e||{},!(this.getUri(t)||e&&e.url))throw new Error("Object has to be not new or URL must be provided");return this.utils.extend(e||{},{method:e&&e.method||"DELETE",url:e&&e.url||this.getUri(t)})},t.prototype.syncRequest=function(t){return t=t||{},t.url=t.url||this.createUrl({sync:!0}),t.query=t.query||t.get||{},t.query.syncToken?t.query={syncType:"ISync",syncToken:t.get.syncToken}:t.query.syncType="FSync",t},t.prototype.nextPageExists=function(t){return t&&t.navigation&&"nextPage"in t.navigation},t.prototype.index=function(t,e,n){return e=e||this.getId.bind(this),t=t||[],t.reduce(function(t,r){var i=e(r);return!i||t[i]&&!n?t:(n?(t[i]||(t[i]=[]),t[i].push(r)):t[i]=r,t)},{})},t.prototype.merge=function(t,e,n,r){var i=this;n=n||this.getId.bind(this),t=t||[],e=e||[];var o=this.index(e,n),s=[],u=t.map(function(t){var e=n(t),u=o[e];return u&&s.push(e),u?r?i.utils.extend(t,u):u:t});return e.forEach(function(t){-1==s.indexOf(n(t))&&u.push(t)}),u},t}();e.Helper=o,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("List",function(){return new o(t)})}var i=n(3),o=function(){function t(t){this.context=t,this.utils=i.$get(t),this.numberComparator=this.numberComparator.bind(this),this.stringComparator=this.stringComparator.bind(this)}return t.prototype.propertyExtractor=function(t){return function(e,n){return t?e&&e[t]||null:e}},t.prototype.stringComparator=function(t,e,n){return this.utils.parseString(t).localeCompare(this.utils.parseString(e))},t.prototype.numberComparator=function(t,e,n){return this.utils.parseNumber(t)-this.utils.parseNumber(e)},t.prototype.comparator=function(t){return t=this.utils.extend({extractFn:this.propertyExtractor(t&&t.sortBy||null).bind(this),compareFn:this.stringComparator.bind(this)},t),function(e,n){return t.compareFn(t.extractFn(e,t),t.extractFn(n,t),t)}},t.prototype.equalsFilter=function(t,e){return e.condition===t},t.prototype.containsFilter=function(t,e){return t&&t.toString().indexOf(e.condition)>-1},t.prototype.regexpFilter=function(t,e){if(!(e.condition instanceof RegExp))throw new Error("Condition must be an instance of RegExp");return e.condition.test(t)},t.prototype.filter=function(t){var e=this,n=this;return t=(t||[]).map(function(t){return e.utils.extend({condition:"",extractFn:n.propertyExtractor(t&&t.filterBy||null).bind(e),filterFn:n.equalsFilter.bind(e)},t)}),function(e){return t.reduce(function(t,n){return t&&n.condition?n.filterFn(n.extractFn(e,n),n):t},!0)}},t}();e.List=o,e.$get=r},function(t,e,n){function r(t){return new s(t)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(2),s=function(t){function e(e){var n=this;t.call(this,e),this.events={change:"change"};var r="hidden",i=function(t){t=t||window.event;var e="visible",i="hidden",o={focus:e,focusin:e,pageshow:e,blur:i,focusout:i,pagehide:i};n.visible=t.type in o?o[t.type]==e:!document[r],n.emit(n.events.change,n.visible)};this.visible=!0,"undefined"!=typeof document&&"undefined"!=typeof window&&(r in document?document.addEventListener("visibilitychange",i):(r="mozHidden")in document?document.addEventListener("mozvisibilitychange",i):(r="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",i):(r="msHidden")in document?document.addEventListener("msvisibilitychange",i):"onfocusin"in document?document.onfocusin=document.onfocusout=i:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=i)}return i(e,t),e.prototype.isVisible=function(){return this.visible},e}(o.Observable);e.PageVisibility=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Platform",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(2),s=n(8),u=n(14),a=function(t){function e(e){t.call(this,e),this.events={accessViolation:"accessViolation",logoutSuccess:"logoutSuccess",logoutError:"logoutError",authorizeSuccess:"authorizeSuccess",authorizeError:"authorizeError",refreshSuccess:"refreshSuccess",refreshError:"refreshError"},this.server="",this.apiKey="",this.account="~",this.urlPrefix="/restapi",this.apiVersion="v1.0",this.accountPrefix="/account/",this.accessTokenTtl=null,this.refreshTokenTtl=36e3,this.refreshTokenTtlRemember=604800,this.refreshHandicapMs=6e4,this.refreshDelayMs=100,this.clearCacheOnRefreshError=!0,this.refreshPromise=null,this.cacheId="platform",this.pollInterval=250,this.releaseTimeout=5e3}return i(e,t),e.prototype.getStorage=function(){return s.$get(this.context)},e.prototype.getRequest=function(){return u.$get(this.context)},e.prototype.clearStorage=function(){return this.getStorage().clean(),this},e.prototype.setCredentials=function(t,e){var n=(t||"")+":"+(e||"");return":"==n?this:(this.apiKey="function"==typeof btoa?btoa(n):new Buffer(n).toString("base64"),this)},e.prototype.getCredentials=function(){var t=("function"==typeof atob?atob(this.apiKey):new Buffer(this.apiKey,"base64").toString("utf-8")).split(":");return{key:t[0],secret:t[1]}},e.prototype.setServer=function(t){return this.server=t||"",this},e.prototype.remember=function(t){var e=this.cacheId+"-remember";return void 0!==t?(this.getStorage().setItem(e,t),this):this.getStorage().getItem(e)||!1},e.prototype.getAuthURL=function(t){return t=t||{},this.apiUrl("/restapi/oauth/authorize?"+this.utils.queryStringify({response_type:"code",redirect_uri:t.redirectUri||"",client_id:this.getCredentials().key,state:t.state||"",brand_id:t.brandId||"",display:t.display||"",prompt:t.prompt||""}),{addServer:!0})},e.prototype.parseAuthRedirectUrl=function(t){var e=this.utils.parseQueryString(t.split("?").reverse()[0]),n=e.error_description||e.error;if(n){var r=new Error(n);throw r.error=e.error,r}return e},e.prototype.authorize=function(t){var e=this;t=t||{},t.remember=t.remember||!1;var n={access_token_ttl:this.accessTokenTtl,refresh_token_ttl:t.remember?this.refreshTokenTtlRemember:this.refreshTokenTtl};if(t.username)n.grant_type="password",n.username=t.username,n.password=t.password,n.extension=t.extension||"";else{if(!t.code)return this.context.getPromise().reject(new Error("Unsupported authorization flow"));n.grant_type="authorization_code",n.code=t.code,n.redirect_uri=t.redirectUri}return this.authCall({url:"/restapi/oauth/token",post:n}).then(function(n){return e.setCache(n.data).remember(t.remember).emitAndCallback(e.events.authorizeSuccess,[]),n})["catch"](function(t){throw e.clearStorage().emitAndCallback(e.events.authorizeError,[t]),t})},e.prototype.isPaused=function(){var t=this.getStorage(),e=this.cacheId+"-refresh";return!!t.getItem(e)&&Date.now()-parseInt(t.getItem(e))<this.releaseTimeout},e.prototype.pause=function(){return this.getStorage().setItem(this.cacheId+"-refresh",Date.now()),this},e.prototype.resume=function(){return this.getStorage().removeItem(this.cacheId+"-refresh"),this},e.prototype.refresh=function(){var t=this,e=new(this.context.getPromise())(function(e,n){return t.isPaused()?e(t.refreshPolling(null)):(t.pause(),void setTimeout(function(){var r=t.getAuthData();return t.log.debug("Platform.refresh(): Performing token refresh (access token",r.access_token,", refresh token",r.refresh_token,")"),r&&r.refresh_token?Date.now()>r.refreshExpireTime?n(new Error("Refresh token has expired")):t.isPaused()?void e(t.authCall({url:"/restapi/oauth/token",post:{grant_type:"refresh_token",refresh_token:r.refresh_token,access_token_ttl:t.accessTokenTtl,refresh_token_ttl:t.remember()?t.refreshTokenTtlRemember:t.refreshTokenTtl}})):n(new Error("Queue was resumed before refresh call")):n(new Error("Refresh token is missing"))},t.refreshDelayMs))});return e.then(function(e){if(!e||!e.data)return e;if(t.log.info("Platform.refresh(): Token was refreshed"),!e.data.refresh_token||!e.data.access_token){var n=new Error("Malformed OAuth response");throw n.ajax=e,n}return t.setCache(e.data).resume(),e}).then(function(e){return t.emit(t.events.refreshSuccess,e),e})["catch"](function(e){throw t.clearCacheOnRefreshError&&t.clearStorage(),t.emitAndCallback(t.events.accessViolation,[e]).emitAndCallback(t.events.refreshError,[e]),e})},e.prototype.logout=function(){var t=this;return this.pause(),this.authCall({url:"/restapi/oauth/revoke",post:{token:this.getToken()}}).then(function(e){return t.resume().clearStorage().emit(t.events.logoutSuccess,e),e})["catch"](function(e){throw t.resume().emitAndCallback(t.events.accessViolation,[e]).emitAndCallback(t.events.logoutError,[e]),e})},e.prototype.refreshPolling=function(t){var e=this;return this.refreshPromise?this.refreshPromise:(this.refreshPromise=new(this.context.getPromise())(function(n,r){e.log.warn("Platform.refresh(): Refresh is already in progress polling started"),e.utils.poll(function(i){return e.isPaused()?i():(e.refreshPromise=null,e.resume(),void(e.isTokenValid()?n(t):r(new Error("Automatic authentification timeout"))))},e.pollInterval)}),this.refreshPromise)},e.prototype.getToken=function(){return this.getAuthData().access_token},e.prototype.getTokenType=function(){return this.getAuthData().token_type},e.prototype.getAuthData=function(){return this.getStorage().getItem(this.cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}},e.prototype.isTokenValid=function(){var t=this.getAuthData();return t.token_type==e.forcedTokenType||new Date(t.expireTime).getTime()-this.refreshHandicapMs>Date.now()&&!this.isPaused()},e.prototype.isAuthorized=function(){return this.isTokenValid()?this.context.getPromise().resolve(!0):this.refresh()},e.prototype.cancelAccessToken=function(){return this.setCache(this.utils.extend(this.getAuthData(),{access_token:"",expires_in:0}))},e.prototype.setCache=function(t){var e=this.getAuthData();return this.log.info("Platform.setCache(): Tokens were updated, new:",t,", old:",e),t.expireTime=Date.now()+1e3*t.expires_in,t.refreshExpireTime=Date.now()+1e3*t.refresh_token_expires_in,this.getStorage().setItem(this.cacheId,t),this},e.prototype.forceAuthentication=function(){return this.setCache({token_type:e.forcedTokenType,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this},e.prototype.apiCall=function(t){var e=this;return t=t||{},t.url=this.apiUrl(t.url,{addServer:!0}),this.isAuthorized().then(function(){var n=e.getToken();return e.getRequest().setOptions(t).setHeader("Authorization",e.getTokenType()+(n?" "+n:"")).send()})["catch"](function(n){if(!n.response||!n.response.isUnauthorized())throw n;return e.cancelAccessToken(),e.refresh().then(function(){return e.apiCall(t)})})},e.prototype.get=function(t,e){return e=e||{},e.url=t,e.method="GET",this.apiCall(e)},e.prototype.post=function(t,e){return e=e||{},e.url=t,e.method="POST",this.apiCall(e)},e.prototype.put=function(t,e){return e=e||{},e.url=t,e.method="PUT",this.apiCall(e)},e.prototype["delete"]=function(t,e){return e=e||{},e.url=t,e.method="DELETE",this.apiCall(e)},e.prototype.authCall=function(t){return t=t||{},t.method=t.method||"POST",t.url=this.apiUrl(t.url,{addServer:!0}),this.getRequest().setOptions(t).setHeader("Content-Type","application/x-www-form-urlencoded").setHeader("Accept","application/json").setHeader("Authorization","Basic "+this.apiKey).send()},e.prototype.apiUrl=function(t,e){t=t||"",e=e||{};var n="",r=-1!=t.indexOf("http://")||-1!=t.indexOf("https://");return e.addServer&&!r&&(n+=this.server),-1!=t.indexOf(this.urlPrefix)||r||(n+=this.urlPrefix+"/"+this.apiVersion),t.indexOf(this.accountPrefix)>-1&&n.replace(this.accountPrefix+"~",this.accountPrefix+this.account),n+=t,(e.addMethod||e.addToken)&&(n+=t.indexOf("?")>-1?"&":"?"),e.addMethod&&(n+="_method="+e.addMethod),e.addToken&&(n+=(e.addMethod?"&":"")+"access_token="+this.getToken()),n},e.forcedTokenType="forced",e}(o.Observable);e.Platform=a,e.$get=r},function(t,e,n){function r(t){return new a(t)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(15),s=n(7),u=n(16),a=function(t){function e(e){t.call(this,e),this.async=!0,this.method="",this.url="",this.query=null,this.body={},this.context=e,this.xhr=null,this.observer=s.$get(e)}return i(e,t),e.prototype.isLoaded=function(){return!!this.xhr},e.prototype.setOptions=function(t){return t=t||{},"body"in t||!t.post||(t.body=t.post),"query"in t||!t.get||(t.query=t.get),"method"in t&&(this.method=t.method),"url"in t&&(this.url=t.url),"query"in t&&(this.query=t.query),"body"in t&&(this.body=t.body),"headers"in t&&this.setHeaders(t.headers),"async"in t&&(this.async=!!t.async),this},e.prototype.checkOptions=function(){if(!this.url)throw new Error("Url is not defined");if(this.hasHeader("Accept")||this.setHeader("Accept",o.Headers.jsonContentType),this.hasHeader("Content-Type")||this.setHeader("Content-Type",o.Headers.jsonContentType),this.method=this.method?this.method.toUpperCase():"GET",["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"].indexOf(this.method)<0)throw new Error("Method has wrong value");return this},e.prototype.getEncodedBody=function(){return"GET"===this.method?null:"string"==typeof this.body?this.body:this.isJson()?JSON.stringify(this.body):this.isUrlEncoded()?this.utils.queryStringify(this.body):this.body},e.prototype.send=function(){var t=this;this.observer.emit(this.observer.events.beforeRequest,this);var e=new(this.context.getPromise())(function(e,n){t.checkOptions();var r=t.getXHR(),i=t.url+(t.query?(t.url.indexOf("?")>-1?"&":"?")+t.utils.queryStringify(t.query):"");r.open(t.method,i,t.async),r.withCredentials=!0,r.onload=function(){var i=u.$get(t.context,r.status,r.statusText,r.responseText,r.getAllResponseHeaders());
if(i.error){var o=i.error;o.ajax=i,o.response=i,o.request=t,n(o)}else e(i)},r.onerror=function(e){var r=new Error("The request cannot be sent"+(e?" ("+e.toString()+")":""));r.request=t,r.response=null,r.ajax=null,n(r)},t.utils.forEach(t.headers,function(t,e){t&&r.setRequestHeader(e,t)}),r.send(t.getEncodedBody()),t.xhr=r});return e.then(function(e){return t.observer.emit(t.observer.events.requestSuccess,e,t),e})["catch"](function(e){throw t.observer.emit(t.observer.events.requestError,e),e})},e.prototype.getXHR=function(){return this.context.getXHR()},e.prototype.destroy=function(){this.xhr&&this.xhr.abort()},e}(o.Headers);e.Request=a,e.$get=r},function(t,e,n){var r=n(3),i=function(){function t(t){this.headers={},this.context=t,this.utils=r.$get(t)}return t.prototype.setHeader=function(t,e){return this.headers[t.toLowerCase()]=e,this},t.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},t.prototype.hasHeader=function(t){return t.toLowerCase()in this.headers},t.prototype.setHeaders=function(t){var e=this;return this.utils.forEach(t,function(t,n){e.setHeader(n,t)}),this},t.prototype.isContentType=function(t){return this.getContentType().indexOf(t)>-1},t.prototype.setContentType=function(e){return this.setHeader(t.contentType,e),this},t.prototype.getContentType=function(){return this.getHeader(t.contentType)||""},t.prototype.isMultipart=function(){return this.isContentType(t.multipartContentType)},t.prototype.isUrlEncoded=function(){return this.isContentType(t.urlencodedContentType)},t.prototype.isJson=function(){return this.isContentType(t.jsonContentType)},t.contentType="Content-Type",t.jsonContentType="application/json",t.multipartContentType="multipart/mixed",t.urlencodedContentType="application/x-www-form-urlencoded",t}();e.Headers=i},function(t,e,n){function r(t,e,n,r,i){return new u(t,e,n,r,i)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(15),s=n(4),u=function(t){function e(n,r,i,u,a){var c=this;if(t.call(this,n),this.log=s.$get(n),"string"==typeof u&&(u=u.replace(/\r/g,""),!a)){var p=u.split(e.bodySeparator);a=p.length>1?p.shift():{},u=p.join(e.bodySeparator)}this.data=null,this.json=null,this.responses=[],this.error=null,1223==r&&(r=204),this.status=r,this.statusText=i,this.body=u;try{if("string"==typeof a?(a||"").split("\n").forEach(function(t){if(t){var n=t.split(e.headerSeparator),r=n.shift().trim();c.setHeader(r,n.join(e.headerSeparator).trim())}}):this.setHeaders(a),this.hasHeader(o.Headers.contentType)||this.setHeader(o.Headers.contentType,o.Headers.jsonContentType),this.isJson()&&this.body&&"string"==typeof this.body)this.json=JSON.parse(this.body),this.data=this.json,this.checkStatus()||(this.error=new Error(this.getError()));else if(this.isMultipart()){var l=this.getContentType().match(/boundary=([^;]+)/i)[1],f=this.body.split(e.boundarySeparator+l);""===f[0].trim()&&f.shift(),f[f.length-1].trim()==e.boundarySeparator&&f.pop();var h=new e(this.context,this.status,"",f.shift());this.responses=f.map(function(t,n){var r=h.data.response[n].status;return new e(c.context,r,"",t)}),this.data=this.responses}else this.data=this.body}catch(d){this.log.error("Response.parseResponse(): Unable to parse data"),this.log.error(d.stack||d),this.log.error(this.body),this.error=d}}return i(e,t),e.prototype.isUnauthorized=function(){return 401==this.status},e.prototype.checkStatus=function(){return this.status>=200&&this.status<300},e.prototype.getError=function(){return this.data.message||this.data.error_description||this.data.description||"Unknown error"},e.boundarySeparator="--",e.headerSeparator=":",e.bodySeparator="\n\n",e}(o.Headers);e.Response=u,e.$get=r},function(t,e,n){function r(t){return new u(t)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(2),s=n(13),u=function(t){function e(e){t.call(this,e),this.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},this.pubnub=null,this.eventFilters=[],this.timeout=null,this.subscription={eventFilters:[],expirationTime:"",expiresIn:0,deliveryMode:{transportType:"PubNub",encryption:!1,address:"",subscriberKey:"",secretKey:""},id:"",creationTime:"",status:"",uri:""}}return i(e,t),e.prototype.getPubnub=function(){return this.context.getPubnub()},e.prototype.getPlatform=function(){return s.$get(this.context)},e.prototype.register=function(t){return this.isSubscribed()?this.renew(t):this.subscribe(t)},e.prototype.addEvents=function(t){return this.eventFilters=this.eventFilters.concat(t),this},e.prototype.setEvents=function(t){return this.eventFilters=t,this},e.prototype.getFullEventFilters=function(){var t=this;return this.eventFilters.map(function(e){return t.getPlatform().apiUrl(e)})},e.prototype.subscribe=function(t){var e=this;return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t,n){if(!e.eventFilters||!e.eventFilters.length)throw new Error("Events are undefined");t(e.getPlatform().apiCall({method:"POST",url:"/restapi/v1.0/subscription",post:{eventFilters:e.getFullEventFilters(),deliveryMode:{transportType:"PubNub"}}}))}).then(function(t){return e.updateSubscription(t.data).subscribeAtPubnub().emit(e.events.subscribeSuccess,t.data),t})["catch"](function(t){throw e.unsubscribe().emit(e.events.subscribeError,t),t})},e.prototype.renew=function(t){var e=this;return t=t||{},t.events&&(this.eventFilters=t.events),this.clearTimeout(),new(this.context.getPromise())(function(t,n){if(!e.subscription||!e.subscription.id)throw new Error("Subscription ID is required");if(!e.eventFilters||!e.eventFilters.length)throw new Error("Events are undefined");t()}).then(function(){return e.getPlatform().apiCall({method:"PUT",url:"/restapi/v1.0/subscription/"+e.subscription.id,post:{eventFilters:e.getFullEventFilters()}})}).then(function(t){return e.updateSubscription(t.data).emit(e.events.renewSuccess,t.data),t})["catch"](function(t){throw e.unsubscribe().emit(e.events.renewError,t),t})},e.prototype.remove=function(t){var e=this;return t=this.utils.extend({async:!0},t),new(this.context.getPromise())(function(n,r){if(!e.subscription||!e.subscription.id)throw new Error("Subscription ID is required");n(e.getPlatform().apiCall({async:!!t.async,method:"DELETE",url:"/restapi/v1.0/subscription/"+e.subscription.id}))}).then(function(t){return e.unsubscribe().emit(e.events.removeSuccess,t),t})["catch"](function(t){throw e.emit(e.events.removeError,t),t})},e.prototype.destroy=function(){return this.unsubscribe(),this.log.info("RC.core.Subscription: Destroyed"),t.prototype.destroy.call(this)},e.prototype.isSubscribed=function(){return this.subscription&&this.subscription.deliveryMode&&this.subscription.deliveryMode.subscriberKey&&this.subscription.deliveryMode.address},e.prototype.setTimeout=function(){var t=this;this.utils.poll(function(e){return Date.now()<t.expireTime?e():void t.renew()},e.pollInterval,this.timeout)},e.prototype.clearTimeout=function(){this.utils.stopPolling(this.timeout)},e.prototype.updateSubscription=function(t){return this.clearTimeout(),this.subscription=t,this.expireTime=Date.now()+1e3*this.subscription.expiresIn-e.renewHandicapMs,this.setTimeout(),this},e.prototype.unsubscribe=function(){return this.clearTimeout(),this.pubnub&&this.isSubscribed()&&this.pubnub.unsubscribe({channel:this.subscription.deliveryMode.address}),this.subscription=null,this},e.prototype.decrypt=function(t){if(this.isSubscribed()&&this.subscription.deliveryMode.encryptionKey){var e=this.getPubnub();t=e.crypto_obj.decrypt(t,this.subscription.deliveryMode.encryptionKey,{encryptKey:!1,keyEncoding:"base64",keyLength:128,mode:"ecb"})}return t},e.prototype.notify=function(t){return this.emit(this.events.notification,this.decrypt(t)),this},e.prototype.subscribeAtPubnub=function(){var t=this;if(!this.isSubscribed())return this;var e=this.getPubnub();return this.pubnub=e.init({ssl:!0,subscribe_key:this.subscription.deliveryMode.subscriberKey}),this.pubnub.ready(),this.pubnub.subscribe({channel:this.subscription.deliveryMode.address,message:function(e,n,r){t.log.info("RC.core.Subscription: Incoming message",e),t.notify(e)},connect:function(){t.log.info("RC.core.Subscription: PUBNUB connected")}}),this},e.renewHandicapMs=6e4,e.pollInterval=1e4,e}(o.Observable);e.Subscription=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Validator",function(){return new o(t)})}var i=n(3),o=function(){function t(t){this.context=t,this.utils=i.$get(t)}return t.prototype.validate=function(t){var e={errors:{},isValid:!0};return e.errors=t.reduce(function(t,n){var r=n.validator();return r.length>0&&(e.isValid=!1,t[n.field]=t[n.field]||[],t[n.field]=t[n.field].concat(r)),t},{}),e},t.prototype.email=function(t,e){var n=this;return function(){return t?n.utils.isEmail(t,e)?[]:[new Error("Value has to be a valid email")]:[]}},t.prototype.phone=function(t){var e=this;return function(){return t?e.utils.isPhoneNumber(t)?[]:[new Error("Value has to be a valid US phone number")]:[]}},t.prototype.required=function(t){return function(){return t?[]:[new Error("Field is required")]}},t.prototype.length=function(t,e,n){return function(){var r=[];return t?(t=t.toString(),n&&t.length<n&&r.push(new Error("Minimum length of "+n+" characters is required")),e&&t.length>e&&r.push(new Error("Maximum length of "+e+" characters is required")),r):r}},t}();e.Validator=o,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Account",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/account/~"},e}(o.Helper);e.Account=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("BlockedNumber",function(){return new u(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(18),u=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/blocked-number"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"phoneNumber",validator:this.validator.phone(t.phoneNumber)},{field:"phoneNumber",validator:this.validator.required(t.phoneNumber)},{field:"name",validator:this.validator.required(t.name)}])},e}(o.Helper);e.BlockedNumber=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Call",function(){return new c(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=n(22),a=n(24),c=function(t){function e(e){t.call(this,e),this.list=s.$get(e),this.contact=a.$get(e),this.presence=u.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"personal"in t||"extensionId"in t||(t.personal=!0),"/account/~/"+(t.personal||t.extensionId?"extension/"+(t.extensionId||"~")+"/":"")+(t.active?"active-calls":"call-log")+(e?"/"+e:"")},e.prototype.getSessionId=function(t){return t&&t.sessionId},e.prototype.isInProgress=function(t){return t&&"In Progress"==t.result},e.prototype.isAlive=function(t){return t&&"Alive"==t.availability},e.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},e.prototype.isOutbound=function(t){return!this.isInbound(t)},e.prototype.isMissed=function(t){return t&&"Missed"==t.result},e.prototype.isFindMe=function(t){return t&&"FindMe"==t.action},e.prototype.getCallerInfo=function(t){return this.isInbound(t)?t.from:t.to},e.prototype.getAllCallerInfos=function(t){return[this.getCallerInfo(t)].concat(this.isInbound(t)?t.to:t.from)},e.prototype.formatDuration=function(t){function e(t){return 10>t?"0"+t:t}var n=parseInt(t.duration),r=Math.floor(n/3600),i=Math.floor(n%3600/60),o=Math.floor(n%60);return(r?r+":":"")+e(i)+":"+e(o)},e.prototype.filter=function(t){return t=this.utils.extend({alive:!0,direction:"",type:""},t),this.list.filter([{filterBy:"direction",condition:t.direction},{filterBy:"type",condition:t.type}])},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"startTime"},t))},e.prototype.attachContacts=function(t,e,n){var r=this,i=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(i,t,n)},e.prototype.checkMergeability=function(t,e,n){var r=function(t){return new Date(t).getTime()};return(!n.strict||t.action&&-1!=t.action.toLowerCase().indexOf("ringout"))&&"Outbound"==t.direction&&"Inbound"==e.direction&&(!e.startTime&&!t.startTime||Math.abs(r(e.startTime)-r(t.startTime))<(n.maxStartTimeDiscrepancy||5e3))&&e.from.phoneNumber==t.to.phoneNumber&&(e.to.phoneNumber==t.from.phoneNumber||e.to.name==t.from.name)},e.prototype.combineCalls=function(t,e,n){n=n||{};var r=[];return t.hasSubsequent=!0,n.merge?(t.duration=t.duration>e.duration?t.duration:e.duration,t.from=e.to,t.to=e.from,r.push(t)):(e.subsequent=!0,e.startTime=t.startTime,r.push(t),r.push(e)),r},e.prototype.processCalls=function(t,e){var n=[],r=[],i=this;return t.forEach(function(o){var s=!1;o.subsequent=!1,o.hasSubsequent=!1,t.some(function(t){return o===t?!1:(i.checkMergeability(o,t,e)&&(n=n.concat(i.combineCalls(o,t,e)),r.push(o),r.push(t),s=!0),s)})}),t.forEach(function(t){-1==r.indexOf(t)&&n.push(t)}),n},e.prototype.parsePresenceCalls=function(t){var e=this;return t.map(function(t){return{id:t.id,uri:"",sessionId:t.sessionId,from:{phoneNumber:t.from},to:{phoneNumber:t.to},direction:t.direction,startTime:"",duration:0,type:"",action:"",result:e.presence.isCallInProgress(t)?"In Progress":t.telephonyStatus,telephonyStatus:t.telephonyStatus}})},e.prototype.getSignature=function(t){var e=function(t){return(t||"").toString().replace(/[^0-9]/gi,"")};return t.direction+"|"+(t.from&&e(t.from.phoneNumber))+"|"+(t.to&&e(t.to.phoneNumber))},e.prototype.mergePresenceCalls=function(t,e){var n=new Date,r=this.parsePresenceCalls(e&&e.activeCalls||[]).map(function(t){return delete t.startTime,t});return t=this.merge(t||[],r,this.getSessionId,!0),t.forEach(function(t){t.startTime||(t.startTime=n.toISOString())}),t},e.prototype.mergeAll=function(t,e,n){var r=this.merge(t||[],e||[],this.getSessionId,!0);return this.merge(r,n||[],this.getSessionId,!0)},e}(o.Helper);e.Call=c,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Presence",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(17),u=n(23),a=function(t){function e(e){t.call(this,e),this.extension=u.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(e||"~")+"/presence"+(t.detailed?"?detailedTelephonyState=true":"")},e.prototype.getId=function(t){return t&&(this.extension.getId(t.extension)||t.extensionId)},e.prototype.isAvailable=function(t){return t&&"Available"==t.presenceStatus},e.prototype.getSubscription=function(t,e){return s.$get(this.context).setEvents([this.createUrl(t,e)])},e.prototype.updateSubscription=function(t,e,n){var r=this,i=e.map(this.getId,this).map(function(t){return r.createUrl(n,t)},this);return t.addEvents(i),t},e.prototype.attachToExtensions=function(t,e,n){var r=this,i=this.index(e);return t.forEach(function(t){var e=i[r.extension.getId(t)];e&&("presence"in t&&n?r.utils.extend(t.presence,e):t.presence=e)},this),this},e.prototype.isCallInProgress=function(t){return t&&"NoCall"!=t.telephonyStatus},e}(o.Helper);e.Presence=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Extension",function(){return new u(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=function(t){function e(e){t.call(this,e),this.type={department:"Department",user:"User",announcement:"Announcement",voicemail:"Voicemail"},this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~"+(t.departmentId?"/department/"+t.departmentId+"/members":"/extension")+(e?"/"+e:"")},e.prototype.isUser=function(t){return t&&t.type==this.type.user},e.prototype.isDepartment=function(t){return t&&t.type==this.type.department},e.prototype.isAnnouncement=function(t){return t&&t.type==this.type.announcement},e.prototype.isVoicemail=function(t){return t&&t.type==this.type.voicemail},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"extensionNumber",compareFn:this.list.numberComparator},t))},e.prototype.filter=function(t){return t=this.utils.extend({search:"",type:""},t),this.list.filter([{filterBy:"type",condition:t.type},{condition:t.search.toLocaleLowerCase(),filterFn:this.list.containsFilter,extractFn:function(t){return(t.name&&t.name.toLocaleLowerCase()+" ")+(t.extensionNumber&&t.extensionNumber.toString().toLocaleLowerCase())}}])},e}(o.Helper);e.Extension=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Contact",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(18),u=n(11),a=function(t){function e(e){t.call(this,e),this.phoneFields=["homePhone","homePhone2","businessPhone","businessPhone2","mobilePhone","companyPhone","assistantPhone","carPhone","otherPhone","callbackPhone"],this.faxFields=["businessFax","otherFax"],this.addressFields=["homeAddress","businessAddress","otherAddress"],this.addressSubFields=["street","city","state","zip"],this.nameFields=["firstName","middleName","lastName","nickName"],this.otherFields=["company","jobTitle","webPage","notes"],this.emailFields=["email","email2","email3"],this.list=u.$get(e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId?t.extensionId:"~")+"/address-book";return t.sync?n+"-sync":n+(t.groupId?"/group/"+t.groupId+"/contact":"/contact")+(e?"/"+e:"")},e.prototype.getFieldValues=function(t,e,n){return e.reduce(function(e,r){return t&&t[r]&&(n?e[r]=t[r]:e.push(t[r])),e},n?{}:[])},e.prototype.getFullName=function(t){return this.getFieldValues(t,this.nameFields).join(" ")},e.prototype.getEmails=function(t,e){return this.getFieldValues(t,this.emailFields,e)},e.prototype.getPhones=function(t,e){return this.getFieldValues(t,this.phoneFields,e)},e.prototype.getFaxes=function(t,e){return this.getFieldValues(t,this.faxFields,e)},e.prototype.getAddresses=function(t,e){return this.getFieldValues(t,this.addressFields,e)},e.prototype.isAlive=function(t){return"Alive"==t.availability},e.prototype.match=function(t,e,n){var r=this;n=this.utils.extend({fields:[].concat(this.nameFields,this.emailFields,this.phoneFields,this.faxFields,this.otherFields),inAddresses:!0,transformFn:function(t,e){return t?t.toString().toLocaleLowerCase():""},strict:!1},n),e=n.transformFn(e,n);var i=null;if(!e)return i;var o=function(t){if(!i){var r=n.transformFn(t,n);if(r){var o=n.strict?r==e:r.indexOf(e)>-1;o&&(i=t)}}};return n.fields.forEach(function(e){o(t[e])}),n.inAddresses&&!i&&this.addressFields.forEach(function(e){t[e]&&!i&&r.addressSubFields.forEach(function(n){o(t[e][n])})}),i},e.prototype.matchAsPhone=function(t,e,n){return this.match(t,e,this.utils.extend({fields:[].concat(this.phoneFields,this.faxFields),inAddresses:!1,transformFn:function(t,e){return t?t.toString().replace(/[^\d\w]/gi,""):""},strict:!1},n))},e.prototype.attachToCallerInfos=function(t,e,n){var r=this,i=this.index(t,function(t){return t.phoneNumber},!0);this.utils.forEach(i,function(t,i){var o=null,s=null;e.some(function(t){return s=r.matchAsPhone(t,i,n),s&&(o=t),s}),o&&t.forEach(function(t){t.contact=o,t.contactPhone=s})})},e.prototype.comparator=function(t){var e=this;return this.list.comparator(this.utils.extend({extractFn:function(t,n){return e.getFullName(t)}},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({alive:!0,startsWith:"",phonesOnly:!1,faxesOnly:!1},t),this.list.filter([{condition:t.alive,filterFn:this.isAlive},{condition:t.startsWith,filterFn:function(t,n){return e.match(t,n.condition)}},{condition:t.phonesOnly,filterFn:function(t,n){return e.getPhones(t).length>0}},{condition:t.faxesOnly,filterFn:function(t,n){return e.getFaxes(t).length>0}}])},e.prototype.validate=function(t){return this.validator.validate([{field:"firstName",validator:this.validator.required(t.firstName)},{field:"lastName",validator:this.validator.required(t.lastName)},{field:"email",validator:this.validator.email(t.email)},{field:"email2",validator:this.validator.email(t.email2)},{field:"email3",validator:this.validator.email(t.email3)}])},e}(o.Helper);e.Contact=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ContactGroup",function(){return new u(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(18),u=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return"/account/~/extension/~/address-book/group"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"groupName",validator:this.validator.required(t&&t.groupName)}])},e}(o.Helper);e.ContactGroup=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Conferencing",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/account/~/extension/~/conferencing"},e}(o.Helper);e.Conferencing=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Country",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(t,e){return"/dictionary/country"},e}(o.Helper);e.Country=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Device",function(){return new c(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(18),u=n(23),a=n(29),c=function(t){function e(e){t.call(this,e),this.validator=s.$get(e),this.extension=u.$get(e),this.deviceModel=a.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},t.order?"/account/~/order":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/device"+(e?"/"+e:"")},e.prototype.validate=function(t){return this.validator.validate([{field:"emergencyServiceAddress-street",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.street)},{field:"emergencyServiceAddress-city",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.city)},{field:"emergencyServiceAddress-state",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.state)},{field:"emergencyServiceAddress-country",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.country)},{field:"emergencyServiceAddress-zip",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.zip)},{field:"emergencyServiceAddress-customerName",validator:this.validator.required(t&&t.emergencyServiceAddress&&t.emergencyServiceAddress.customerName)},{field:"extension",validator:this.validator.required(this.extension.getId(t&&t.extension))},{field:"model",validator:this.validator.required(this.deviceModel.getId(t&&t.model))}])},e}(o.Helper);e.Device=c,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("DeviceModel",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.getId=function(t){return t?t.sku:null},e.prototype.createUrl=function(t,e){return"/dictionary/device"},e}(o.Helper);e.DeviceModel=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ForwardingNumber",function(){return new u(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=function(t){function e(e){t.call(this,e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/forwarding-number"+(e?"/"+e:"")},e.prototype.getId=function(t){return t&&(t.id||t.phoneNumber)},e.prototype.hasFeature=function(t,e){return!!t&&!!t.features&&-1!=t.features.indexOf(e)},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"label"},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({features:[]},t),this.list.filter([{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},e}(o.Helper);e.ForwardingNumber=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Language",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(t,e){return"/dictionary/language"},e}(o.Helper);e.Language=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Location",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=n(33),a=function(t){function e(e){t.call(this,e),this.list=s.$get(e),this.state=u.$get(e)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/location"},e.prototype.filter=function(t){var e=this,n=[];return t=this.utils.extend({stateId:"",onlyUniqueNPA:!1},t),this.list.filter([{condition:t.stateId,filterFn:function(t,n){return e.state.getId(t.state)==n.condition}},{condition:t.onlyUniqueNPA,filterFn:function(t,e){return-1==n.indexOf(t.npa)?(n.push(t.npa),!0):!1}}])},e.prototype.comparator=function(t){return t=this.utils.extend({sortBy:"npa"},t),"nxx"==t.sortBy&&(t.extractFn=function(t){return 1e6*parseInt(t.npa)+parseInt(t.nxx)},t.compareFn=this.list.numberComparator),this.list.comparator(t)},e}(o.Helper);e.Location=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("State",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=n(27),a=function(t){function e(e){t.call(this,e),this.countryHelper=u.$get(e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/state"},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({countryId:""},t),this.list.filter([{condition:t.countryId,filterFn:function(t,n){return e.countryHelper.getId(t.country)==n.condition}}])},e}(o.Helper);e.State=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Message",function(){return new l(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=n(18),a=n(17),c=n(13),p=n(24),l=function(t){function e(e){t.call(this,e),this.contact=p.$get(e),this.list=s.$get(e),this.platform=c.$get(e),this.validator=u.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){t=t||{};var n="/account/~/extension/"+(t.extensionId||"~");return t.fax?n+"/fax":t.sms?n+"/sms":t.pager?n+"/company-pager":t.sync?n+"/message-sync":n+"/message-store"+(e?"/"+e:"")},e.prototype.isInbound=function(t){return t&&"Inbound"==t.direction},e.prototype.isOutbound=function(t){return!this.isInbound(t)},e.prototype.isSMS=function(t){return t&&"SMS"==t.type},e.prototype.isPager=function(t){return t&&"Pager"==t.type},e.prototype.isVoiceMail=function(t){return t&&"VoiceMail"==t.type},e.prototype.isFax=function(t){return t&&"Fax"==t.type},e.prototype.isAlive=function(t){return t&&"Alive"==t.availability},e.prototype.isRead=function(t){return"Read"==t.readStatus},e.prototype.setIsRead=function(t,e){return t.readStatus=e?"Read":"Unread",t},e.prototype.getAttachmentUrl=function(t,e){return t.attachments[e]?this.platform.apiUrl(t.attachments[e].uri,{addMethod:"GET",addServer:!0,addToken:!0}):""},e.prototype.getAttachmentContentType=function(t,e){return t.attachments[e]?t.attachments[e].contentType:""},e.prototype.getSubscription=function(t){return a.$get(this.context).setEvents([this.createUrl(t)])},e.prototype.getCallerInfos=function(t){return this.isInbound(t)?[t.from]:t.to},e.prototype.getAllCallerInfos=function(t){return this.getCallerInfos(t).concat(this.isInbound(t)?t.to:[t.from])},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({sortBy:"creationTime"},t))},e.prototype.filter=function(t){return t=this.utils.extend({search:"",alive:!0,direction:"",conversationId:"",readStatus:""},t),this.list.filter([{condition:t.alive,filterFn:this.isAlive},{filterBy:"type",condition:t.type},{filterBy:"direction",condition:t.direction},{filterBy:"conversationId",condition:t.conversationId},{filterBy:"readStatus",condition:t.readStatus},{filterBy:"subject",condition:t.search,filterFn:this.list.containsFilter}])},e.prototype.attachContacts=function(t,e,n){var r=this,i=e.reduce(function(t,e){return t.concat(r.getAllCallerInfos(e))},[]);this.contact.attachToCallerInfos(i,t,n)},e.prototype.shorten=function(t){return{from:t.from,to:t.to,text:t.subject}},e.prototype.validateSMS=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(this.utils.getProperty(t,"to[0].phoneNumber"))},{field:"from",validator:this.validator.required(this.utils.getProperty(t,"from.phoneNumber"))},{field:"subject",validator:this.validator.required(this.utils.getProperty(t,"subject"))},{field:"subject",validator:this.validator.length(this.utils.getProperty(t,"subject"),160)}])},e.prototype.validatePager=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(this.utils.getProperty(t,"to.extensionNumber"))},{field:"from",validator:this.validator.required(this.utils.getProperty(t,"from.extensionNumber"))
},{field:"subject",validator:this.validator.required(this.utils.getProperty(t,"subject"))},{field:"subject",validator:this.validator.length(this.utils.getProperty(t,"subject"),160)}])},e}(o.Helper);e.Message=l,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("PhoneNumber",function(){return new a(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(11),u=n(23),a=function(t){function e(e){t.call(this,e),this.tollFreeAreaCodes=["800","844","855","866","877","888"],this.extension=u.$get(e),this.list=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},t.lookup?"/number-pool/lookup":"/account/~"+(t.extensionId?"/extension/"+t.extensionId:"")+"/phone-number"+(e?"/"+e:"")},e.prototype.isSMS=function(t){return this.hasFeature(t,"SmsSender")},e.prototype.hasFeature=function(t,e){return!!t.features&&-1!=t.features.indexOf(e)},e.prototype.reserve=function(t,e){t.reservedTill=new Date(e).toISOString()},e.prototype.unreserve=function(t){t.reservedTill=null},e.prototype.comparator=function(t){return this.list.comparator(this.utils.extend({extractFn:function(t){return t.usageType+"-"+t.paymentType+"-"+t.type}},t))},e.prototype.filter=function(t){var e=this;return t=this.utils.extend({usageType:"",paymentType:"",type:"",features:[]},t),this.list.filter([{filterBy:"usageType",condition:t.usageType},{filterBy:"paymentType",condition:t.paymentType},{filterBy:"type",condition:t.type},{condition:t.features.length,filterFn:function(n){return t.features.some(function(t){return e.hasFeature(n,t)})}}])},e}(o.Helper);e.PhoneNumber=a,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Ringout",function(){return new u(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=n(18),u=function(t){function e(e){t.call(this,e),this.validator=s.$get(e)}return i(e,t),e.prototype.createUrl=function(t,e){return t=t||{},"/account/~/extension/"+(t.extensionId||"~")+"/ringout"+(e?"/"+e:"")},e.prototype.resetAsNew=function(e){return e=t.prototype.resetAsNew.call(this,e),e&&delete e.status,e},e.prototype.isInProgress=function(t){return t&&!this.isNew(t)&&t.status&&"InProgress"==t.status.callStatus},e.prototype.isSuccess=function(t){return t&&!this.isNew(t)&&t.status&&"Success"==t.status.callStatus},e.prototype.isError=function(t){return!this.isNew(t)&&!this.isInProgress(t)&&!this.isSuccess(t)},e.prototype.validate=function(t){return this.validator.validate([{field:"to",validator:this.validator.required(t&&t.to&&t.to.phoneNumber)},{field:"from",validator:this.validator.required(t&&t.from&&t.from.phoneNumber)}])},e}(o.Helper);e.Ringout=u,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Service",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments),this.isSmsEnabled=this.isServiceFeatureEnabledMethod("SMS"),this.isSmsReceivingEnabled=this.isServiceFeatureEnabledMethod("SMSReceiving"),this.isPresenceEnabled=this.isServiceFeatureEnabledMethod("Presence"),this.isRingOutEnabled=this.isServiceFeatureEnabledMethod("RingOut"),this.isInternationalCallingEnabled=this.isServiceFeatureEnabledMethod("InternationalCalling"),this.isDndEnabled=this.isServiceFeatureEnabledMethod("DND"),this.isFaxEnabled=this.isServiceFeatureEnabledMethod("Fax"),this.isFaxReceivingEnabled=this.isServiceFeatureEnabledMethod("FaxReceiving"),this.isVoicemailEnabled=this.isServiceFeatureEnabledMethod("Voicemail"),this.isPagerEnabled=this.isServiceFeatureEnabledMethod("Pager"),this.isPagerReceivingEnabled=this.isServiceFeatureEnabledMethod("PagerReceiving"),this.isVoipCallingEnabled=this.isServiceFeatureEnabledMethod("VoipCalling"),this.isVideoConferencingEnabled=this.isServiceFeatureEnabledMethod("VideoConferencing"),this.isSalesForceEnabled=this.isServiceFeatureEnabledMethod("SalesForce"),this.isIntercomEnabled=this.isServiceFeatureEnabledMethod("Intercom"),this.isPagingEnabled=this.isServiceFeatureEnabledMethod("Paging"),this.isConferencingEnabled=this.isServiceFeatureEnabledMethod("Conferencing"),this.isFreeSoftPhoneLinesEnabled=this.isServiceFeatureEnabledMethod("FreeSoftPhoneLines"),this.isHipaaComplianceEnabled=this.isServiceFeatureEnabledMethod("HipaaCompliance"),this.isCallParkEnabled=this.isServiceFeatureEnabledMethod("CallPark"),this.isOnDemandCallRecordingEnabled=this.isServiceFeatureEnabledMethod("OnDemandCallRecording")}return i(e,t),e.prototype.createUrl=function(){return"/account/~/service-info"},e.prototype.isEnabled=function(t,e){return e.reduce(function(e,n){return n.featureName==t&&(e=n.enabled),e},!1)},e.prototype.isServiceFeatureEnabledMethod=function(t){var e=this;return function(n){return e.isEnabled(t,n)}},e}(o.Helper);e.Service=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("ShippingMethod",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/shipping-options"},e}(o.Helper);e.ShippingMethod=s,e.$get=r},function(t,e,n){function r(t){return t.createSingleton("Timezone",function(){return new s(t)})}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),s=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.createUrl=function(){return"/dictionary/timezone"},e}(o.Helper);e.Timezone=s,e.$get=r},function(t,e,n){var r;(function(i,o){!function(i){function s(){for(var t=0;t<O.length;t++)O[t][0](O[t][1]);O=[],_=!1}function u(t,e){O.push([t,e]),_||(_=!0,C(s,0))}function a(t,e){function n(t){l(e,t)}function r(t){h(e,t)}try{t(n,r)}catch(i){r(i)}}function c(t){var e=t.owner,n=e.state_,r=e.data_,i=t[n],o=t.then;if("function"==typeof i){n=S;try{r=i(r)}catch(s){h(o,s)}}p(o,r)||(n===S&&l(o,r),n===k&&h(o,r))}function p(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(r){n||(n=!0,e!==r?l(t,r):f(t,r))},function(e){n||(n=!0,h(t,e))}),!0}}catch(i){return n||h(t,i),!0}return!1}function l(t,e){t!==e&&p(t,e)||f(t,e)}function f(t,e){t.state_===x&&(t.state_=w,t.data_=e,u(y,t))}function h(t,e){t.state_===x&&(t.state_=w,t.data_=e,u(g,t))}function d(t){t.then_=t.then_.forEach(c)}function y(t){t.state_=S,d(t)}function g(t){t.state_=k,d(t)}function m(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof m==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],a(t,this)}var v=i.Promise,b=v&&"resolve"in v&&"reject"in v&&"all"in v&&"race"in v&&function(){var t;return new v(function(e){t=e}),"function"==typeof t}();"undefined"!=typeof e&&e?e.Promise=b?v:m:(r=function(){return b?v:m}.call(e,n,e,t),!(void 0!==r&&(t.exports=r)));var _,x="pending",w="sealed",S="fulfilled",k="rejected",E=function(){},C="undefined"!=typeof o?o:setTimeout,O=[];m.prototype={constructor:m,state_:x,then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(E),fulfilled:t,rejected:e};return this.state_===S||this.state_===k?u(c,n):this.then_.push(n),n.then},"catch":function(t){return this.then(null,t)}},m.all=function(t){var e=this;if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new e(function(e,n){function r(t){return s++,function(n){o[t]=n,--s||e(o)}}for(var i,o=[],s=0,u=0;u<t.length;u++)i=t[u],i&&"function"==typeof i.then?i.then(r(u),n):o[u]=i;s||e(o)})},m.race=function(t){var e=this;if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new e(function(e,n){for(var r,i=0;i<t.length;i++)r=t[i],r&&"function"==typeof r.then?r.then(e,n):e(r)})},m.resolve=function(t){var e=this;return t&&"object"==typeof t&&t.constructor===e?t:new e(function(e){e(t)})},m.reject=function(t){var e=this;return new e(function(e,n){n(t)})}}("undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this)}).call(e,function(){return this}(),n(41).setImmediate)},function(t,e,n){(function(t,r){function i(t,e){this._id=t,this._clearFn=e}var o=n(42).nextTick,s=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;e.setTimeout=function(){return new i(s.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(s.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var n=c++,r=arguments.length<2?!1:u.call(arguments,1);return a[n]=!0,o(function(){a[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof r?r:function(t){delete a[t]}}).call(e,n(41).setImmediate,n(41).clearImmediate)},function(t,e){function n(){c=!1,s.length?a=s.concat(a):p=-1,a.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=a.length;e;){for(s=a,a=[];++p<e;)s&&s[p].run();p=-1,e=a.length}s=null,c=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function o(){}var s,u=t.exports={},a=[],c=!1,p=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new i(t,e)),1!==a.length||c||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(module,exports,__webpack_require__){(function(module){window.JSON&&window.JSON.stringify||function(){function toJSON(t){try{return this.valueOf()}catch(e){return null}}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,o,s,u=gap,a=e[t];switch(a&&"object"==typeof a&&(a=toJSON.call(a,t)),"function"==typeof rep&&(a=rep.call(e,t,a)),typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(a)){for(o=a.length,n=0;o>n;n+=1)s[n]=str(n,a)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+u+"]":"["+s.join(",")+"]",gap=u,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)r=rep[n],"string"==typeof r&&(i=str(r,a),i&&s.push(quote(r)+(gap?": ":":")+i));else for(r in a)Object.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&s.push(quote(r)+(gap?": ":":")+i));return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+u+"}":"{"+s.join(",")+"}",gap=u,i}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}(),window.PUBNUB||function(){function t(){return"x"+ ++N+ +new Date}function e(){return+new Date}function r(t,e){var n=t.join(z),r=[];return e?(p(e,function(t,e){var n="object"==typeof e?JSON.stringify(e):e;"undefined"!=typeof e&&null!=e&&h(n).length>0&&r.push(t+"="+h(n))}),n+="?"+r.join(J)):n}function i(t,n){var r,i=0,o=function(){i+n>e()?(clearTimeout(r),r=setTimeout(o,n)):(i=e(),t())};return o}function o(t,e){var n=[];return p(t||[],function(t){e(t)&&n.push(t)}),n}function s(t,e){return t.replace(G,function(t,n){return e[n]||t})}function u(t,e){return setTimeout(t,e)}function a(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});return t&&t(e),e}function c(t){return!!t&&"string"!=typeof t&&(Array.isArray&&Array.isArray(t)||"number"==typeof t.length)}function p(t,e){if(t&&e)if(c(t))for(var n=0,r=t.length;r>n;)e.call(t[n],t[n],n++);else for(var n in t)t.hasOwnProperty&&t.hasOwnProperty(n)&&e.call(t[n],n,t[n])}function l(t,e){var n=[];return p(t||[],function(t,r){n.push(e(t,r))}),n}function f(t){return encodeURIComponent(t).replace(/[!'()*~]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function h(t){return encodeURIComponent(t)}function d(t,e){var n=[];return p(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function y(t,e){var n=[];return p(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function g(){u(function(){H||(H=1,p(B,function(t){t()}))},q)}function m(m){function v(t){return t||(t={}),p(jt,function(e,n){e in t||(t[e]=n)}),t}function b(t){var e=[];return p(t,function(t,n){e.push(t)}),e}function _(t){return b(t).sort()}function x(t){var e="",n=_(t);for(var r in n){var i=n[r];e+=i+"="+f(t[i]),r!=n.length-1&&(e+="&")}return e}function w(t,e,n){var r=!1;if("undefined"==typeof t)return e;if("number"==typeof t)r=t>K||0==t?!1:!0;else{if("boolean"==typeof t)return t?V:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+K+" or x = 0). Current Value : "+(e||K)),e||K):t}function S(t,e){return zt.encrypt(t,e||Bt)||t}function E(t,e){return zt.decrypt(t,e||Bt)||zt.decrypt(t,Bt)||t}function C(){return clearTimeout(Et),!Ot||Ot>=500||1>Ot||!d(wt,!0).length&&!y(St,!0).length?void(Tt=!1):(Tt=!0,void Jt.presence_heartbeat({callback:function(t){Et=u(C,Ot*q)},error:function(t){It&&It("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(t)),Et=u(C,Ot*q)}}))}function O(){!Tt&&C()}function T(t){if(Pt){if(!ht.length)return}else{if(t&&(ht.sending=0),ht.sending||!ht.length)return;ht.sending=1}Mt(ht.shift())}function P(t){var e=0;return p(y(St),function(n){var r=St[n];r&&(e++,(t||function(){})(r))}),e}function A(t){var e=0;return p(d(wt),function(n){var r=wt[n];r&&(e++,(t||function(){})(r))}),e}function M(t,e,n){if("object"==typeof t){if(t.error){var r={};return t.message&&(r.message=t.message),t.payload&&(r.payload=t.payload),void(n&&n(r))}if(t.payload)return void(t.next_page?e&&e(t.payload,t.next_page):e&&e(t.payload))}e&&e(t)}function j(t,e){if("object"==typeof t&&t.error){var n={};return t.message&&(n.message=t.message),t.payload&&(n.payload=t.payload),void(e&&e(n))}e&&e(t)}function I(t,e,n,r){var e=t.callback||e,i=t.error||It,o=Nt();r=r||{},r.auth||(r.auth=t.auth_key||ot);var s=[pt,"v1","channel-registration","sub-key",it];s.push.apply(s,n),o&&(r.callback=o),Mt({callback:o,data:v(r),success:function(t){M(t,e,i)},fail:function(t){j(t,i)},url:s})}function F(){Ft()||R(1,{error:"Offline. Please check your network settings. "}),G&&clearTimeout(G),G=u(F,q)}function N(){et&&Jt.time(function(t){J(function(){},t),t||R(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),Q&&clearTimeout(Q),Q=u(N,tt)})}function R(t,e){vt&&vt(t,e),vt=null,clearTimeout(G),clearTimeout(Q)}function z(t){var n=e()-yt;return n-t/1e4}function J(t,n){function r(n){if(n){var r=n/1e4,o=(e()-i)/2;yt=e()-(r+o),t&&t(yt)}}var i=e();n&&r(n)||Jt.time(r)}var G,Q,Y=+m.windowing||$,Z=(+m.timeout||L)*q,tt=(+m.keepalive||D)*q,et=m.timecheck||0,nt=m.noleave||0,rt=m.publish_key,it=m.subscribe_key,ot=m.auth_key||"",st=m.secret_key||"",ut=m.hmac_SHA256,at=m.ssl?"s":"",ct="http"+at+"://"+(m.origin||"pubsub.pubnub.com"),pt=W(ct),lt=W(ct),ft=function(){},ht=[],dt=!0,yt=0,gt=0,mt=0,vt=0,bt=m.restore||0,_t=0,xt=!1,wt={},St={},kt={},Et=null,Ct=w(m.heartbeat||m.pnexpires||0,m.error),Ot=m.heartbeat_interval||Ct/2-1,Tt=!1,Pt=m.no_wait_for_pending,At=m["compatible_3.5"]||!1,Mt=m.xdr,jt=m.params||{},It=m.error||function(){},Ft=m._is_online||function(){return 1},Nt=m.jsonp_cb||function(){return 0},Ht=m.db||{get:function(){},set:function(){}},Bt=m.cipher_key,Ut=m.uuid||!m.unique_uuid&&Ht&&Ht.get(it+"uuid")||"",$t=m.instance_id||!1,Rt="",Lt=m.shutdown,Dt="undefined"!=typeof m.use_send_beacon?m.use_send_beacon:!0,qt=Dt?m.sendBeacon:null;2===Ct&&(Ot=1);var zt=m.crypto_obj||{encrypt:function(t,e){return t},decrypt:function(t,e){return t}},Jt={LEAVE:function(t,e,n,i,o){var s,u,a={uuid:Ut,auth:n||ot},c=W(ct),i=i||function(){},p=o||function(){},l=Nt();if(t.indexOf(U)>0)return!0;if(At){if(!at)return!1;if("0"==l)return!1}return nt?!1:("0"!=l&&(a.callback=l),$t&&(a.instanceid=Rt),s=[c,"v2","presence","sub_key",it,"channel",h(t),"leave"],u=v(a),qt&&(url_string=r(s,u),qt(url_string))?(i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Mt({blocking:e||at,timeout:2e3,callback:l,data:u,success:function(t){M(t,i,p)},fail:function(t){j(t,p)},url:s}),!0))},LEAVE_GROUP:function(t,e,n,i,o){var s,u,a={uuid:Ut,auth:n||ot},c=W(ct),i=i||function(){},p=o||function(){},l=Nt();if(t.indexOf(U)>0)return!0;if(At){if(!at)return!1;if("0"==l)return!1}return nt?!1:("0"!=l&&(a.callback=l),t&&t.length>0&&(a["channel-group"]=t),$t&&(a.instanceid=Rt),s=[c,"v2","presence","sub_key",it,"channel",h(","),"leave"],u=v(a),qt&&(url_string=r(s,u),qt(url_string))?(i&&i({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Mt({blocking:e||at,timeout:5e3,callback:l,data:u,success:function(t){M(t,i,p)},fail:function(t){j(t,p)},url:s}),!0))},set_resumed:function(t){xt=t},get_cipher_key:function(){return Bt},set_cipher_key:function(t){Bt=t},raw_encrypt:function(t,e){return S(t,e)},raw_decrypt:function(t,e){return E(t,e)},get_heartbeat:function(){return Ct},set_heartbeat:function(t,e){Ct=w(t,Ct,It),Ot=e||Ct/2-1,2==Ct&&(Ot=1),ft(),C()},get_heartbeat_interval:function(){return Ot},set_heartbeat_interval:function(t){Ot=t,C()},get_version:function(){return X},getGcmMessageObject:function(t){return{data:t}},getApnsMessageObject:function(t){var e={aps:{badge:1,alert:""}};for(k in t)k[e]=t[k];return e},newPnMessage:function(){var t={};gcm&&(t.pn_gcm=gcm),apns&&(t.pn_apns=apns);for(k in n)t[k]=n[k];return t},_add_param:function(t,e){jt[t]=e},channel_group:function(t,e){var n,r,i=t.channel_group,e=e||t.callback,o=t.channels||t.channel,s=t.cloak,u=[],a={},p=t.mode||"add";if(i){var l=i.split(":");l.length>1?(n="*"===l[0]?null:l[0],r=l[1]):r=l[0]}n&&u.push("namespace")&&u.push(h(n)),u.push("channel-group"),r&&"*"!==r&&u.push(r),o?(c(o)&&(o=o.join(",")),a[p]=o,a.cloak=dt?"true":"false"):"remove"===p&&u.push("remove"),"undefined"!=typeof s&&(a.cloak=s?"true":"false"),I(t,e,u,a)},channel_group_list_groups:function(t,e){var n;n=t.namespace||t.ns||t.channel_group||null,n&&(t.channel_group=n+":*"),Jt.channel_group(t,e)},channel_group_list_channels:function(t,e){return t.channel_group?void Jt.channel_group(t,e):It("Missing Channel Group")},channel_group_remove_channel:function(t,e){return t.channel_group?t.channel||t.channels?(t.mode="remove",void Jt.channel_group(t,e)):It("Missing Channel"):It("Missing Channel Group")},channel_group_remove_group:function(t,e){return t.channel_group?t.channel?It("Use channel_group_remove_channel if you want to remove a channel from a group."):(t.mode="remove",void Jt.channel_group(t,e)):It("Missing Channel Group")},channel_group_add_channel:function(t,e){return t.channel_group?t.channel||t.channels?void Jt.channel_group(t,e):It("Missing Channel"):It("Missing Channel Group")},channel_group_cloak:function(t,e){return"undefined"==typeof t.cloak?void e(dt):(dt=t.cloak,void Jt.channel_group(t,e))},channel_group_list_namespaces:function(t,e){var n=["namespace"];I(t,e,n)},channel_group_remove_namespace:function(t,e){var n=["namespace",t.namespace,"remove"];I(t,e,n)},history:function(t,e){var e=t.callback||e,n=t.count||t.limit||100,r=t.reverse||"false",i=t.error||function(){},o=t.auth_key||ot,s=t.cipher_key,u=t.channel,a=t.channel_group,c=t.start,p=t.end,l=t.include_token,f=t.string_message_token||!1,d={},y=Nt();return u||a?e?it?(d.stringtoken="true",d.count=n,d.reverse=r,d.auth=o,a&&(d["channel-group"]=a,u||(u=",")),y&&(d.callback=y),c&&(d.start=c),p&&(d.end=p),l&&(d.include_token="true"),f&&(d.string_message_token="true"),void Mt({callback:y,data:v(d),success:function(t){if("object"==typeof t&&t.error)return void i({message:t.message,payload:t.payload});for(var n=t[0],r=[],o=0;o<n.length;o++)if(l){var u=E(n[o].message,s),a=n[o].timetoken;try{r.push({message:JSON.parse(u),timetoken:a})}catch(c){r.push({message:u,timetoken:a})}}else{var u=E(n[o],s);try{r.push(JSON.parse(u))}catch(c){r.push(u)}}e([r,t[1],t[2]])},fail:function(t){j(t,i)},url:[pt,"v2","history","sub-key",it,"channel",h(u)]})):It("Missing Subscribe Key"):It("Missing Callback"):It("Missing Channel")},replay:function(t,e){var n,e=e||t.callback||function(){},r=t.auth_key||ot,i=t.source,o=t.destination,s=t.stop,u=t.start,a=t.end,c=t.reverse,p=t.limit,l=Nt(),f={};return i?o?rt?it?("0"!=l&&(f.callback=l),s&&(f.stop="all"),c&&(f.reverse="true"),u&&(f.start=u),a&&(f.end=a),p&&(f.count=p),f.auth=r,n=[pt,"v1","replay",rt,it,i,o],void Mt({callback:l,success:function(t){M(t,e,err)},fail:function(){e([0,"Disconnected"])},url:n,data:v(f)})):It("Missing Subscribe Key"):It("Missing Publish Key"):It("Missing Destination Channel"):It("Missing Source Channel")},auth:function(t){ot=t,ft()},time:function(t){var e=Nt(),n={uuid:Ut,auth:ot};$t&&(n.instanceid=Rt),Mt({callback:e,data:v(n),timeout:5*q,url:[pt,"time",e],success:function(e){t(e[0])},fail:function(){t(0)}})},publish:function(t,e){var n=t.message;if(!n)return It("Missing Message");var r,i,e=e||t.callback||n.callback||function(){},o=t.channel||n.channel,s=t.auth_key||ot,u=t.cipher_key,a=t.error||n.error||function(){},c=t.post||!1,p="store_in_history"in t?t.store_in_history:!0,l=Nt(),f="push";return t.prepend&&(f="unshift"),o?rt?it?(n.getPubnubMessage&&(n=n.getPubnubMessage()),n=JSON.stringify(S(n,u)),i=[pt,"publish",rt,it,0,h(o),l,h(n)],r={uuid:Ut,auth:s},p||(r.store="0"),$t&&(r.instanceid=Rt),ht[f]({callback:l,timeout:5*q,url:i,data:v(r),fail:function(t){j(t,a),T(1)},success:function(t){M(t,e,a),T(1)},mode:c?"POST":"GET"}),void T()):It("Missing Subscribe Key"):It("Missing Publish Key"):It("Missing Channel")},unsubscribe:function(t,e){var n=t.channel,r=t.channel_group,i=t.auth_key||ot,e=e||t.callback||function(){},o=t.error||function(){};if(_t=0,bt=1,n){var s=l((n.join?n.join(","):""+n).split(","),function(t){return wt[t]?t:void 0}).join(",");n=l((n.join?n.join(","):""+n).split(","),function(t){return wt[t]?t+","+t+U:void 0}).join(","),p(n.split(","),function(t){t&&(wt[t]=0,t in kt&&delete kt[t])});var u=!0;H&&(u=Jt.LEAVE(s,0,i,e,o)),u||e({action:"leave"})}if(r){var a=l((r.join?r.join(","):""+r).split(","),function(t){return St[t]?t:void 0}).join(",");r=l((r.join?r.join(","):""+r).split(","),function(t){return St[t]?t+","+t+U:void 0}).join(","),p(r.split(","),function(t){t&&(St[t]=0,t in kt&&delete kt[t])});var u=!0;H&&(u=Jt.LEAVE_GROUP(a,0,i,e,o)),u||e({action:"leave"})}ft()},subscribe:function(t,n){function r(t){t?u(ft,k):(pt=W(ct,1),lt=W(ct,1),u(function(){Jt.time(r)},q)),A(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))}),P(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))})}function i(){var t=Nt(),e=d(wt).join(","),n=y(St).join(",");if(e||n){e||(e=","),R();var o=v({uuid:Ut,auth:ot});n&&(o["channel-group"]=n);var s=JSON.stringify(kt);s.length>2&&(o.state=JSON.stringify(kt)),Ct&&(o.heartbeat=Ct),$t&&(o.instanceid=Rt),O(),vt=Mt({timeout:S,callback:t,fail:function(t){t&&t.error&&t.service?(j(t,g),r(1)):Jt.time(function(e){!e&&j(t,g),r(e)})},data:v(o),url:[lt,"subscribe",it,h(e),t,_t],success:function(t){if(!t||"object"==typeof t&&"error"in t&&t.error)return g(t.error),u(ft,q);if(m(t[1]),_t=!_t&&bt&&Ht.get(it)||t[1],A(function(t){t.connected||(t.connected=1,t.connect(t.name))}),P(function(t){t.connected||(t.connected=1,t.connect(t.name))}),xt&&!bt)return _t=0,xt=!1,Ht.set(it,0),void u(i,k);x&&(_t=1e4,x=0),Ht.set(it,t[1]);var e=function(){var e="",n="";t.length>3?(e=t[3],n=t[2]):e=t.length>2?t[2]:l(d(wt),function(e){return l(Array(t[0].length).join(",").split(","),function(){return e})}).join(",");var r=e.split(","),i=n?n.split(","):[];return function(){var t=r.shift()||mt,e=i.shift(),n={};e?(t&&t.indexOf("-pnpres")>=0&&e.indexOf("-pnpres")<0&&(e+="-pnpres"),n=St[e]||wt[e]||{callback:function(){}}):n=wt[t];var o=[n.callback||gt,t.split(U)[0]];return e&&o.push(e.split(U)[0]),o}}(),n=z(+t[1]);p(t[0],function(r){var i=e(),o=E(r,wt[i[1]]?wt[i[1]].cipher_key:null);i[0]&&i[0](o,t,i[2]||i[1],n,i[1])}),u(i,k)}})}}var o=t.channel,s=t.channel_group,n=n||t.callback,n=n||t.message,a=t.connect||function(){},c=t.reconnect||function(){},f=t.disconnect||function(){},g=t.error||g||function(){},m=t.idle||function(){},b=t.presence||0,_=t.noheresync||0,x=t.backfill||0,w=t.timetoken||0,S=t.timeout||Z,k=t.windowing||Y,C=t.state,T=t.heartbeat||t.pnexpires,M=t.heartbeat_interval,I=t.restore||bt;return ot=t.auth_key||ot,bt=I,_t=w,o||s?n?it?((T||0===T||M||0===M)&&Jt.set_heartbeat(T,M),o&&p((o.join?o.join(","):""+o).split(","),function(r){var i=wt[r]||{};wt[mt=r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:gt=n,cipher_key:t.cipher_key,connect:a,disconnect:f,reconnect:c},C&&(r in C?kt[r]=C[r]:kt[r]=C),b&&(Jt.subscribe({channel:r+U,callback:b,restore:I}),i.subscribed||_||Jt.here_now({channel:r,data:v({uuid:Ut,auth:ot}),callback:function(t){p("uuids"in t?t.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(e()/1e3),occupancy:t.occupancy||1},t,r)})}}))}),s&&p((s.join?s.join(","):""+s).split(","),function(r){var i=St[r]||{};St[r]={name:r,connected:i.connected,disconnected:i.disconnected,subscribed:1,callback:gt=n,cipher_key:t.cipher_key,connect:a,disconnect:f,reconnect:c},b&&(Jt.subscribe({channel_group:r+U,callback:b,restore:I,auth_key:ot}),i.subscribed||_||Jt.here_now({channel_group:r,data:v({uuid:Ut,auth:ot}),callback:function(t){p("uuids"in t?t.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(e()/1e3),occupancy:t.occupancy||1},t,r)})}}))}),ft=function(){R(),u(i,k)},H?void ft():B.push(ft)):It("Missing Subscribe Key"):It("Missing Callback"):It("Missing Channel")},here_now:function(t,e){var e=t.callback||e,n=t.debug,r=t.error||function(){},i=t.auth_key||ot,o=t.channel,s=t.channel_group,u=Nt(),a="uuids"in t?t.uuids:!0,c=t.state,p={uuid:Ut,auth:i};if(a||(p.disable_uuids=1),c&&(p.state=1),!e)return It("Missing Callback");if(!it)return It("Missing Subscribe Key");var l=[pt,"v2","presence","sub_key",it];o&&l.push("channel")&&l.push(h(o)),"0"!=u&&(p.callback=u),s&&(p["channel-group"]=s,!o&&l.push("channel")&&l.push(",")),$t&&(p.instanceid=Rt),Mt({callback:u,data:v(p),success:function(t){M(t,e,r)},fail:function(t){j(t,r)},debug:n,url:l})},where_now:function(t,e){var e=t.callback||e,n=t.error||function(){},r=t.auth_key||ot,i=Nt(),o=t.uuid||Ut,s={auth:r};return e?it?("0"!=i&&(s.callback=i),$t&&(s.instanceid=Rt),void Mt({callback:i,data:v(s),success:function(t){M(t,e,n)},fail:function(t){j(t,n)},url:[pt,"v2","presence","sub_key",it,"uuid",h(o)]})):It("Missing Subscribe Key"):It("Missing Callback")},state:function(t,e){var n,e=t.callback||e||function(t){},r=t.error||function(){},i=t.auth_key||ot,o=Nt(),s=t.state,u=t.uuid||Ut,a=t.channel,c=t.channel_group,p=v({auth:i});return it?u?a||c?("0"!=o&&(p.callback=o),"undefined"!=typeof a&&wt[a]&&wt[a].subscribed&&s&&(kt[a]=s),"undefined"!=typeof c&&St[c]&&St[c].subscribed&&(s&&(kt[c]=s),p["channel-group"]=c,a||(a=",")),p.state=JSON.stringify(s),$t&&(p.instanceid=Rt),n=s?[pt,"v2","presence","sub-key",it,"channel",a,"uuid",u,"data"]:[pt,"v2","presence","sub-key",it,"channel",a,"uuid",h(u)],void Mt({callback:o,data:v(p),success:function(t){M(t,e,r)},fail:function(t){j(t,r)},url:n})):It("Missing Channel"):It("Missing UUID"):It("Missing Subscribe Key")},grant:function(t,e){var e=t.callback||e,n=t.error||function(){},r=t.channel||t.channels,i=t.channel_group,o=Nt(),s=t.ttl,u=t.read?"1":"0",a=t.write?"1":"0",p=t.manage?"1":"0",l=t.auth_key||t.auth_keys;if(!e)return It("Missing Callback");if(!it)return It("Missing Subscribe Key");if(!rt)return It("Missing Publish Key");if(!st)return It("Missing Secret Key");var f=Math.floor((new Date).getTime()/1e3),h=it+"\n"+rt+"\ngrant\n",d={w:a,r:u,timestamp:f};t.manage&&(d.m=p),c(r)&&(r=r.join(",")),c(l)&&(l=l.join(",")),"undefined"!=typeof r&&null!=r&&r.length>0&&(d.channel=r),"undefined"!=typeof i&&null!=i&&i.length>0&&(d["channel-group"]=i),"0"!=o&&(d.callback=o),(s||0===s)&&(d.ttl=s),l&&(d.auth=l),d=v(d),l||delete d.auth,h+=x(d);var y=ut(h,st);y=y.replace(/\+/g,"-"),y=y.replace(/\//g,"_"),d.signature=y,Mt({callback:o,data:d,success:function(t){M(t,e,n)},fail:function(t){j(t,n)},url:[pt,"v1","auth","grant","sub-key",it]})},mobile_gw_provision:function(t){var e,n,r=t.callback||function(){},i=t.auth_key||ot,o=t.error||function(){},s=Nt(),u=t.channel,a=t.op,c=t.gw_type,p=t.device_id;return p?c?a?u?rt?it?(n=[pt,"v1/push/sub-key",it,"devices",p],e={uuid:Ut,auth:i,type:c},"add"==a?e.add=u:"remove"==a&&(e.remove=u),$t&&(data.instanceid=Rt),void Mt({callback:s,data:e,success:function(t){M(t,r,o)},fail:function(t){j(t,o)},url:n})):It("Missing Subscribe Key"):It("Missing Publish Key"):It("Missing gw destination Channel (channel)"):It("Missing GW Operation (op: add or remove)"):It("Missing GW Type (gw_type: gcm or apns)"):It("Missing Device ID (device_id)")},audit:function(t,e){var e=t.callback||e,n=t.error||function(){},r=t.channel,i=t.channel_group,o=t.auth_key,s=Nt();if(!e)return It("Missing Callback");if(!it)return It("Missing Subscribe Key");if(!rt)return It("Missing Publish Key");if(!st)return It("Missing Secret Key");var u=Math.floor((new Date).getTime()/1e3),a=it+"\n"+rt+"\naudit\n",c={timestamp:u};"0"!=s&&(c.callback=s),"undefined"!=typeof r&&null!=r&&r.length>0&&(c.channel=r),"undefined"!=typeof i&&null!=i&&i.length>0&&(c["channel-group"]=i),o&&(c.auth=o),c=v(c),o||delete c.auth,a+=x(c);var p=ut(a,st);p=p.replace(/\+/g,"-"),p=p.replace(/\//g,"_"),c.signature=p,Mt({callback:s,data:c,success:function(t){M(t,e,n)},fail:function(t){j(t,n)},url:[pt,"v1","auth","audit","sub-key",it]
})},revoke:function(t,e){t.read=!1,t.write=!1,Jt.grant(t,e)},set_uuid:function(t){Ut=t,ft()},get_uuid:function(){return Ut},isArray:function(t){return c(t)},get_subscibed_channels:function(){return d(wt,!0)},presence_heartbeat:function(t){var e=t.callback||function(){},n=t.error||function(){},r=Nt(),i={uuid:Ut,auth:ot},o=JSON.stringify(kt);o.length>2&&(i.state=JSON.stringify(kt)),Ct>0&&320>Ct&&(i.heartbeat=Ct),"0"!=r&&(i.callback=r);var s=h(d(wt,!0).join(",")),u=y(St,!0).join(",");s||(s=","),u&&(i["channel-group"]=u),$t&&(i.instanceid=Rt),Mt({callback:r,data:v(i),timeout:5*q,url:[pt,"v2","presence","sub-key",it,"channel",s,"heartbeat"],success:function(t){M(t,e,n)},fail:function(t){j(t,n)}})},stop_timers:function(){clearTimeout(G),clearTimeout(Q),clearTimeout(Et)},shutdown:function(){Jt.stop_timers(),Lt&&Lt()},xdr:Mt,ready:g,db:Ht,uuid:a,map:l,each:p,"each-channel":A,grep:o,offline:function(){R(1,{message:"Offline. Please check your network settings."})},supplant:s,now:e,unique:t,updater:i};return Ut||(Ut=Jt.uuid()),Rt||(Rt=Jt.uuid()),Ht.set(it+"uuid",Ut),G=u(F,q),Q=u(N,tt),Et=u(O,(Ot-3)*q),J(),Jt}function v(){function t(t){return CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex)}function e(t){return t=t||{},t.hasOwnProperty("encryptKey")||(t.encryptKey=p.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=p.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=p.keyLength),t.hasOwnProperty("mode")||(t.mode=p.mode),-1==u.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=p.keyEncoding),-1==a.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=p.keyLength),-1==c.indexOf(t.mode.toLowerCase())&&(t.mode=p.mode),t}function n(t,e){return"base64"==e.keyEncoding?CryptoJS.enc.Base64.parse(t):"hex"==e.keyEncoding?CryptoJS.enc.Hex.parse(t):t}function r(e,r){return e=n(e,r),r.encryptKey?CryptoJS.enc.Utf8.parse(t(e).slice(0,32)):e}function i(t){return"ecb"==t.mode?CryptoJS.mode.ECB:CryptoJS.mode.CBC}function o(t){return"cbc"==t.mode?CryptoJS.enc.Utf8.parse(s):null}var s="0123456789012345",u=["hex","utf8","base64","binary"],a=[128,256],c=["ecb","cbc"],p={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"};return{encrypt:function(t,n,s){if(!n)return t;s=e(s);var u=o(s),a=i(s),c=r(n,s),p=JSON.stringify(t),l=CryptoJS.AES.encrypt(p,c,{iv:u,mode:a}).ciphertext,f=l.toString(CryptoJS.enc.Base64);return f||t},decrypt:function(t,n,s){if(!n)return t;s=e(s);var u=o(s),a=i(s),c=r(n,s);try{var p=CryptoJS.enc.Base64.parse(t),l=CryptoJS.AES.decrypt({ciphertext:p},c,{iv:u,mode:a}).toString(CryptoJS.enc.Utf8),f=JSON.parse(l);return f}catch(h){return}}}}function b(t,e){var n=CryptoJS.HmacSHA256(t,e);return n.toString(CryptoJS.enc.Base64)}function _(t){return document.getElementById(t)}function x(t){console.error(t)}function w(t,e){var n=[];return p(t.split(/\s+/),function(t){p((e||document).getElementsByTagName(t),function(t){n.push(t)})}),n}function S(t,e,n){p(t.split(","),function(t){var r=function(t){t||(t=window.event),n(t)||(t.cancelBubble=!0,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())};e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r})}function E(){return w("head")[0]}function C(t,e,n){return n?void t.setAttribute(e,n):t&&t.getAttribute&&t.getAttribute(e)}function O(t,e){for(var n in e)if(e.hasOwnProperty(n))try{t.style[n]=e[n]+("|width|height|top|left|".indexOf(n)>0&&"number"==typeof e[n]?"px":"")}catch(r){}}function T(t){return document.createElement(t)}function P(){return et||F()?0:t()}function A(e){if(et||F())return M(e);var n=T("script"),i=e.callback,o=t(),s=0,a=e.timeout||R,c=u(function(){d(1,{message:"timeout"})},a),p=e.fail||function(){},l=e.data||{},f=e.success||function(){},h=function(){E().appendChild(n)},d=function(t,e){s||(s=1,n.onerror=null,clearTimeout(c),t||!e||f(e),u(function(){t&&p();var e=_(o),n=e&&e.parentNode;n&&n.removeChild(e)},q))};return window[i]=function(t){d(0,t)},e.blocking||(n[Y]=Y),n.onerror=function(){d(1)},n.src=r(e.url,l),C(n,"id",o),h(),d}function M(t){var e,n,i=function(){if(!s){s=1,clearTimeout(c);try{n=JSON.parse(e.responseText)}catch(t){return d(1)}o=1,f(n)}},o=0,s=0,a=t.timeout||R,c=u(function(){d(1,{message:"timeout"})},a),p=t.fail||function(){},l=t.data||{},f=t.success||function(){},h=!t.blocking,d=function(t,n){o||(o=1,clearTimeout(c),e&&(e.onerror=e.onload=null,e.abort&&e.abort(),e=null),t&&p(n))};try{e=F()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest,e.onerror=e.onabort=function(t){d(1,t||e&&e.responseText||{error:"Network Connection Error"})},e.onload=e.onloadend=i,e.onreadystatechange=function(){if(e&&4==e.readyState)switch(e.status){case 200:break;default:try{n=JSON.parse(e.responseText),d(1,n)}catch(t){return d(1,{status:e.status,payload:null,message:e.responseText})}return}};var y=r(t.url,l);e.open("GET",y,h),h&&(e.timeout=a),e.send()}catch(g){return d(0),et=0,A(t)}return d}function j(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(t){return!0}}function I(t){return"sendBeacon"in navigator?navigator.sendBeacon(t):!1}function F(){if(!ut||!ut.get)return 0;var t={id:F.id++,send:function(){},abort:function(){t.id={}},open:function(e,n){F[t.id]=t,ut.get(t.id,n)}};return t}var N=1,H=!1,B=[],U="-pnpres",$=10,R=1e4,L=310,D=60,q=1e3,z="/",J="&",K=5,V=30,X="3.7.16",G=/{([\w\-]+)}/g,W=function(){var t=20,e=Math.floor(Math.random()*t);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?a().split("-")[0]:++e<t?e:e=1))||n}}(),Q="https://pubnub.a.ssl.fastly.net/pubnub.swf",Y="async",Z=navigator.userAgent,tt="PubNub-JS-Web/3.7.16",et=-1==Z.indexOf("MSIE 6");window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var nt=function(){var t={},e=!1;try{e=window.localStorage}catch(n){}var r=function(t){return-1==document.cookie.indexOf(t)?null:((document.cookie||"").match(RegExp(t+"=([^;]+)"))||[])[1]||null},i=function(t,e){document.cookie=t+"="+e+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"},o=function(){try{return i("pnctest","1"),"1"===r("pnctest")}catch(t){return!1}}();return{get:function(n){try{return e?e.getItem(n):o?r(n):t[n]}catch(i){return t[n]}},set:function(n,r){try{if(e)return e.setItem(n,r)&&0;o&&i(n,r),t[n]=r}catch(s){t[n]=r}}}}(),rt={list:{},unbind:function(t){rt.list[t]=[]},bind:function(t,e){(rt.list[t]=rt.list[t]||[]).push(e)},fire:function(t,e){p(rt.list[t]||[],function(t){t(e)})}},it=_("pubnub")||0,ot=function(t){et=t.jsonp?0:-1==Z.indexOf("MSIE 6");var e=t.subscribe_key||"",n=((+t.keepalive||D)*q,t.uuid||nt.get(e+"uuid")||"",t.leave_on_unload||0);t.xdr=A,t.db=nt,t.error=t.error||x,t._is_online=j,t.jsonp_cb=P,t.hmac_SHA256=b,t.crypto_obj=v(),t.sendBeacon=I,t.params={pnsdk:tt};var r=function(t){return ot(t)},i=m(t);for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o]);return r.css=O,r.$=_,r.create=T,r.bind=S,r.head=E,r.search=w,r.attr=C,r.events=rt,r.init=r,r.secure=r,r.crypto_obj=v(),S("beforeunload",window,function(){return n&&r["each-channel"](function(t){r.LEAVE(t.name,0)}),!0}),t.notest?r:(S("offline",window,r.offline),S("offline",document,r.offline),r)};ot.init=ot,ot.secure=ot,ot.crypto_obj=v(),"complete"===document.readyState?u(g,0):S("load",window,function(){u(g,0)});var st=it||{};PUBNUB=ot({notest:1,publish_key:C(st,"pub-key"),subscribe_key:C(st,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==C(st,"ssl"),origin:C(st,"origin"),uuid:C(st,"uuid")}),window.jQuery&&(window.jQuery.PUBNUB=ot),"undefined"!=typeof module&&(module.exports=PUBNUB)&&g();var ut=_("pubnubs")||0;it&&(O(it,{position:"absolute",top:-q}),("opera"in window||C(it,"flash"))&&(it.innerHTML="<object id=pubnubs data="+Q+"><param name=movie value="+Q+"><param name=allowscriptaccess value=always></object>"),PUBNUB.rdx=function(t,e){return e?(F[t].responseText=unescape(e),void F[t].onload()):F[t].onerror()},F.id=q)}(),function(){var t=PUBNUB.ws=function(e,n){if(!(this instanceof t))return new t(e,n);var r=this,e=r.url=e||"",i=(r.protocol=n||"Sec-WebSocket-Protocol",e.split("/")),o={ssl:"wss:"===i[0],origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};return r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.CLOSED=3,r.CLOSE_NORMAL=1e3,r.CLOSE_GOING_AWAY=1001,r.CLOSE_PROTOCOL_ERROR=1002,r.CLOSE_UNSUPPORTED=1003,r.CLOSE_TOO_LARGE=1004,r.CLOSE_NO_STATUS=1005,r.CLOSE_ABNORMAL=1006,r.onclose=r.onerror=r.onmessage=r.onopen=r.onsend=function(){},r.binaryType="",r.extensions="",r.bufferedAmount=0,r.trasnmitting=!1,r.buffer=[],r.readyState=r.CONNECTING,e?(r.pubnub=PUBNUB.init(o),r.pubnub.setup=o,r.setup=o,void r.pubnub.subscribe({restore:!1,channel:o.channel,disconnect:r.onerror,reconnect:r.onopen,error:function(){r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(t){r.onmessage({data:t})},connect:function(){r.readyState=r.OPEN,r.onopen()}})):(r.readyState=r.CLOSED,r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),r)};t.prototype.send=function(t){var e=this;e.pubnub.publish({channel:e.pubnub.setup.channel,message:t,callback:function(t){e.onsend({data:t})}})},t.prototype.close=function(){var t=this;t.pubnub.unsubscribe({channel:t.pubnub.setup.channel}),t.readyState=t.CLOSED,t.onclose({})}}();var CryptoJS=CryptoJS||function(t,e){var n={},r=n.lib={},i=function(){},o=r.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes;if(t=t.sigBytes,this.clamp(),r%4)for(var i=0;t>i;i++)e[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;t>i;i+=4)e[r+i>>>2]=n[i>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],r=0;e>r;r+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),u=n.enc={},a=u.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;t>r;r++){var i=e[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-4*(r%8);return new s.init(n,e/2)}},c=u.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;t>r;r++)n.push(String.fromCharCode(e[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;e>r;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-8*(r%4);return new s.init(n,e)}},p=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),u=e?t.ceil(u):t.max((0|u)-this._minBufferSize,0);if(e=u*o,i=t.min(4*e,i),e){for(var a=0;e>a;a+=o)this._doProcessBlock(r,a);a=r.splice(0,e),n.sigBytes-=i}return new s.init(a,i)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});r.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new f.HMAC.init(t,n).finalize(e)}}});var f=n.algo={};return n}(Math);!function(t){for(var e=CryptoJS,n=e.lib,r=n.WordArray,i=n.Hasher,n=e.algo,o=[],s=[],u=function(t){return 4294967296*(t-(0|t))|0},a=2,c=0;64>c;){var p;t:{p=a;for(var l=t.sqrt(p),f=2;l>=f;f++)if(!(p%f)){p=!1;break t}p=!0}p&&(8>c&&(o[c]=u(t.pow(a,.5))),s[c]=u(t.pow(a,1/3)),c++),a++}var h=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],u=n[3],a=n[4],c=n[5],p=n[6],l=n[7],f=0;64>f;f++){if(16>f)h[f]=0|t[e+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=l+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&p)+s[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&o^i&o),l=p,p=c,c=a,a=u+d|0,u=o,o=i,i=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+p|0,n[7]=n[7]+l|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=t.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math),function(){var t=CryptoJS,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var r=t.blockSize,i=4*r;n.sigBytes>i&&(n=t.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),u=o.words,a=s.words,c=0;r>c;c++)u[c]^=1549556828,a[c]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp(),t=[];for(var i=0;n>i;i+=3)for(var o=(e[i>>>2]>>>24-8*(i%4)&255)<<16|(e[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|e[i+2>>>2]>>>24-8*((i+2)%4)&255,s=0;4>s&&n>i+.75*s;s++)t.push(r.charAt(o>>>6*(3-s)&63));if(e=r.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,r=this._map,i=r.charAt(64);i&&(i=t.indexOf(i),-1!=i&&(n=i));for(var i=[],o=0,s=0;n>s;s++)if(s%4){var u=r.indexOf(t.charAt(s-1))<<2*(s%4),a=r.indexOf(t.charAt(s))>>>6-2*(s%4);i[o>>>2]|=(u|a)<<24-8*(o%4),o++}return e.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,n,r,i,o,s){return t=t+(e&n|~e&r)+i+s,(t<<o|t>>>32-o)+e}function n(t,e,n,r,i,o,s){return t=t+(e&r|n&~r)+i+s,(t<<o|t>>>32-o)+e}function r(t,e,n,r,i,o,s){return t=t+(e^n^r)+i+s,(t<<o|t>>>32-o)+e}function i(t,e,n,r,i,o,s){return t=t+(n^(e|~r))+i+s,(t<<o|t>>>32-o)+e}for(var o=CryptoJS,s=o.lib,u=s.WordArray,a=s.Hasher,s=o.algo,c=[],p=0;64>p;p++)c[p]=4294967296*t.abs(t.sin(p+1))|0;s=s.MD5=a.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,o){for(var s=0;16>s;s++){var u=o+s,a=t[u];t[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var s=this._hash.words,u=t[o+0],a=t[o+1],p=t[o+2],l=t[o+3],f=t[o+4],h=t[o+5],d=t[o+6],y=t[o+7],g=t[o+8],m=t[o+9],v=t[o+10],b=t[o+11],_=t[o+12],x=t[o+13],w=t[o+14],S=t[o+15],k=s[0],E=s[1],C=s[2],O=s[3],k=e(k,E,C,O,u,7,c[0]),O=e(O,k,E,C,a,12,c[1]),C=e(C,O,k,E,p,17,c[2]),E=e(E,C,O,k,l,22,c[3]),k=e(k,E,C,O,f,7,c[4]),O=e(O,k,E,C,h,12,c[5]),C=e(C,O,k,E,d,17,c[6]),E=e(E,C,O,k,y,22,c[7]),k=e(k,E,C,O,g,7,c[8]),O=e(O,k,E,C,m,12,c[9]),C=e(C,O,k,E,v,17,c[10]),E=e(E,C,O,k,b,22,c[11]),k=e(k,E,C,O,_,7,c[12]),O=e(O,k,E,C,x,12,c[13]),C=e(C,O,k,E,w,17,c[14]),E=e(E,C,O,k,S,22,c[15]),k=n(k,E,C,O,a,5,c[16]),O=n(O,k,E,C,d,9,c[17]),C=n(C,O,k,E,b,14,c[18]),E=n(E,C,O,k,u,20,c[19]),k=n(k,E,C,O,h,5,c[20]),O=n(O,k,E,C,v,9,c[21]),C=n(C,O,k,E,S,14,c[22]),E=n(E,C,O,k,f,20,c[23]),k=n(k,E,C,O,m,5,c[24]),O=n(O,k,E,C,w,9,c[25]),C=n(C,O,k,E,l,14,c[26]),E=n(E,C,O,k,g,20,c[27]),k=n(k,E,C,O,x,5,c[28]),O=n(O,k,E,C,p,9,c[29]),C=n(C,O,k,E,y,14,c[30]),E=n(E,C,O,k,_,20,c[31]),k=r(k,E,C,O,h,4,c[32]),O=r(O,k,E,C,g,11,c[33]),C=r(C,O,k,E,b,16,c[34]),E=r(E,C,O,k,w,23,c[35]),k=r(k,E,C,O,a,4,c[36]),O=r(O,k,E,C,f,11,c[37]),C=r(C,O,k,E,y,16,c[38]),E=r(E,C,O,k,v,23,c[39]),k=r(k,E,C,O,x,4,c[40]),O=r(O,k,E,C,u,11,c[41]),C=r(C,O,k,E,l,16,c[42]),E=r(E,C,O,k,d,23,c[43]),k=r(k,E,C,O,m,4,c[44]),O=r(O,k,E,C,_,11,c[45]),C=r(C,O,k,E,S,16,c[46]),E=r(E,C,O,k,p,23,c[47]),k=i(k,E,C,O,u,6,c[48]),O=i(O,k,E,C,y,10,c[49]),C=i(C,O,k,E,w,15,c[50]),E=i(E,C,O,k,h,21,c[51]),k=i(k,E,C,O,_,6,c[52]),O=i(O,k,E,C,l,10,c[53]),C=i(C,O,k,E,v,15,c[54]),E=i(E,C,O,k,a,21,c[55]),k=i(k,E,C,O,g,6,c[56]),O=i(O,k,E,C,S,10,c[57]),C=i(C,O,k,E,d,15,c[58]),E=i(E,C,O,k,x,21,c[59]),k=i(k,E,C,O,f,6,c[60]),O=i(O,k,E,C,b,10,c[61]),C=i(C,O,k,E,p,15,c[62]),E=i(E,C,O,k,m,21,c[63]);s[0]=s[0]+k|0,s[1]=s[1]+E|0,s[2]=s[2]+C|0,s[3]=s[3]+O|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;n[i>>>5]|=128<<24-i%32;var o=t.floor(r/4294967296);for(n[(i+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[(i+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(n.length+1),this._process(),e=this._hash,n=e.words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),o.MD5=a._createHelper(s),o.HmacMD5=a._createHmacHelper(s)}(Math),function(){var t=CryptoJS,e=t.lib,n=e.Base,r=e.WordArray,e=t.algo,i=e.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=n.hasher.create(),o=r.create(),s=o.words,u=n.keySize,n=n.iterations;s.length<u;){a&&i.update(a);var a=i.update(t).finalize(e);i.reset();for(var c=1;n>c;c++)a=i.finalize(a),i.reset();o.concat(a)}return o.sigBytes=4*u,o}});t.EvpKDF=function(t,e,n){return i.create(n).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=CryptoJS,n=e.lib,r=n.Base,i=n.WordArray,o=n.BufferedBlockAlgorithm,s=e.enc.Base64,u=e.algo.EvpKDF,a=n.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,r){return("string"==typeof n?d:h).encrypt(t,e,n,r)},decrypt:function(e,n,r){return("string"==typeof n?d:h).decrypt(t,e,n,r)}}}});n.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=e.mode={},p=function(e,n,r){var i=this._iv;i?this._iv=t:i=this._prevBlock;for(var o=0;r>o;o++)e[n+o]^=i[o]},l=(n.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();l.Encryptor=l.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize;p.call(this,t,e,r),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),l.Decryptor=l.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize,i=t.slice(e,e+r);n.decryptBlock(t,e),p.call(this,t,e,r),this._prevBlock=i}}),c=c.CBC=l,l=(e.pad={}).Pkcs7={pad:function(t,e){for(var n=4*e,n=n-t.sigBytes%n,r=n<<24|n<<16|n<<8|n,o=[],s=0;n>s;s+=4)o.push(r);n=i.create(o,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},n.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:l}),reset:function(){a.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=n.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),c=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return t=t.salt,(t?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){t=s.parse(t);var e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var n=i.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:n})}},h=n.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(t,e,n,r){r=this.cfg.extend(r);var i=t.createEncryptor(n,r);return e=i.finalize(e),i=i.cfg,f.create({ciphertext:e,key:n,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),t.createDecryptor(n,r).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),e=(e.kdf={}).OpenSSL={execute:function(t,e,n,r){return r||(r=i.random(8)),t=u.create({keySize:e+n}).compute(t,r),n=i.create(t.words.slice(e),4*n),t.sigBytes=4*e,f.create({key:t,iv:n,salt:r})}},d=n.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:e}),encrypt:function(t,e,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,t.keySize,t.ivSize),r.iv=n.iv,t=h.encrypt.call(this,t,e,n.key,r),t.mixIn(n),t},decrypt:function(t,e,n,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),n=r.kdf.execute(n,t.keySize,t.ivSize,e.salt),r.iv=n.iv,h.decrypt.call(this,t,e,n.key,r)}})}(),function(){for(var t=CryptoJS,e=t.lib.BlockCipher,n=t.algo,r=[],i=[],o=[],s=[],u=[],a=[],c=[],p=[],l=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;for(var y=0,g=0,d=0;256>d;d++){var m=g^g<<1^g<<2^g<<3^g<<4,m=m>>>8^255&m^99;r[y]=m,i[m]=y;var v=h[y],b=h[v],_=h[b],x=257*h[m]^16843008*m;o[y]=x<<24|x>>>8,s[y]=x<<16|x>>>16,u[y]=x<<8|x>>>24,a[y]=x,x=16843009*_^65537*b^257*v^16843008*y,c[m]=x<<24|x>>>8,p[m]=x<<16|x>>>16,l[m]=x<<8|x>>>24,f[m]=x,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,n=t.sigBytes/4,t=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],o=0;t>o;o++)if(n>o)i[o]=e[o];else{var s=i[o-1];o%n?n>6&&4==o%n&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=s<<8|s>>>24,s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=w[o/n|0]<<24),i[o]=i[o-n]^s}for(e=this._invKeySchedule=[],n=0;t>n;n++)o=t-n,s=n%4?i[o]:i[o-4],e[n]=4>n||4>=o?s:c[r[s>>>24]]^p[r[s>>>16&255]]^l[r[s>>>8&255]]^f[r[255&s]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,o,s,u,a,r)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,c,p,l,f,i),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,r,i,o,s,u){for(var a=this._nRounds,c=t[e]^n[0],p=t[e+1]^n[1],l=t[e+2]^n[2],f=t[e+3]^n[3],h=4,d=1;a>d;d++)var y=r[c>>>24]^i[p>>>16&255]^o[l>>>8&255]^s[255&f]^n[h++],g=r[p>>>24]^i[l>>>16&255]^o[f>>>8&255]^s[255&c]^n[h++],m=r[l>>>24]^i[f>>>16&255]^o[c>>>8&255]^s[255&p]^n[h++],f=r[f>>>24]^i[c>>>16&255]^o[p>>>8&255]^s[255&l]^n[h++],c=y,p=g,l=m;y=(u[c>>>24]<<24|u[p>>>16&255]<<16|u[l>>>8&255]<<8|u[255&f])^n[h++],g=(u[p>>>24]<<24|u[l>>>16&255]<<16|u[f>>>8&255]<<8|u[255&c])^n[h++],m=(u[l>>>24]<<24|u[f>>>16&255]<<16|u[c>>>8&255]<<8|u[255&p])^n[h++],f=(u[f>>>24]<<24|u[c>>>16&255]<<16|u[p>>>8&255]<<8|u[255&l])^n[h++],t[e]=y,t[e+1]=g,t[e+2]=m,t[e+3]=f},keySize:8});t.AES=e._createHelper(n)}(),CryptoJS.mode.ECB=function(){var t=CryptoJS.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),t.Decryptor=t.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),t}()}).call(exports,__webpack_require__(44)(module))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_45__},function(t,e){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_46__){var n=new Error('Cannot find module "undefined"');throw n.code="MODULE_NOT_FOUND",n}t.exports=__WEBPACK_EXTERNAL_MODULE_46__}])});
//# sourceMappingURL=rc-sdk-bundle.min.js.map
